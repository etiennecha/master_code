(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    106664,       2835]
NotebookOptionsPosition[    101089,       2648]
NotebookOutlinePosition[    101573,       2666]
CellTagsIndexPosition[    101530,       2663]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Search Advertising: Numerical analysis", "Title",
 CellChangeTimes->{{3.5989415182915487`*^9, 3.598941530227742*^9}}],

Cell["Model: demand function, consumer type, and profit", "Subsubtitle",
 CellChangeTimes->{{3.598941534916211*^9, 3.598941567204439*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Demand", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", " ", "pbar_", ",", " ", "eta_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"p", " ", ">", " ", "pbar"}]}], "}"}], "}"}], ",", 
    RowBox[{"theta", " ", "+", " ", 
     RowBox[{"p", "^", 
      RowBox[{"(", 
       RowBox[{"-", "eta"}], ")"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InverseDemand", "[", 
   RowBox[{"theta_", ",", " ", "q_", ",", " ", "eta_"}], "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"theta", " ", ">", "q"}]}], "}"}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q", "-", "theta"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "eta"}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CdfTheta", "[", 
   RowBox[{"theta_", ",", " ", "gamma_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"theta", " ", "<", "0"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", 
        RowBox[{"theta", " ", ">", " ", "1"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"theta", "^", "gamma"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PdfTheta", "[", 
    RowBox[{"theta_", ",", " ", "gamma_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"CdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", "theta"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Profit", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", " ", "pbar_", ",", " ", "eta_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"p", ">", "pbar"}]}], " ", "}"}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "0.1"}], ")"}], "*", 
     RowBox[{"Demand", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivativeProfit", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", "pbar_", ",", " ", "eta_"}], "]"}], 
  "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Profit", "[", 
     RowBox[{"theta", ",", "p", ",", "pbar", ",", "eta"}], "]"}], ",", "p"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.598937564340193*^9, 3.598937565254284*^9}, {
  3.5989376158323417`*^9, 3.5989376383935976`*^9}, {3.598937716681425*^9, 
  3.5989378639381495`*^9}, {3.598937900915847*^9, 3.5989379040521603`*^9}, {
  3.598937985462301*^9, 3.5989379871104655`*^9}, {3.5989381460443573`*^9, 
  3.598938314211172*^9}, {3.5989384547462244`*^9, 3.598938476491399*^9}, {
  3.5989415781855373`*^9, 3.598941581351854*^9}, {3.5989428182945356`*^9, 
  3.59894287984669*^9}, {3.5998935082959642`*^9, 3.5998935086639643`*^9}, {
  3.6010530831063805`*^9, 3.601053087962623*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {"0", 
     RowBox[{"theta", "<", "0"}]},
    {
     RowBox[{"gamma", " ", 
      SuperscriptBox["theta", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "gamma"}]]}], 
     RowBox[{"0", "<", "theta", "<", "1"}]},
    {"0", 
     RowBox[{"theta", ">", "1"}]},
    {"Indeterminate", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.5989428417128773`*^9, 3.5989428812008257`*^9}, 
   3.5995379730602446`*^9, 3.5998821665142117`*^9, 3.5998870043819647`*^9, 
   3.5998935122309647`*^9, 3.6010530902051*^9, 3.6010931219606194`*^9, 
   3.601100112172861*^9, 3.6011171300246305`*^9, {3.6011220062482696`*^9, 
   3.601122026386283*^9}, 3.6011220841850624`*^9}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {"0", 
     RowBox[{
      RowBox[{"p", "-", "pbar"}], ">", "0"}]},
    {
     RowBox[{
      FractionBox[
       RowBox[{"eta", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.1`"}], "+", "p"}], ")"}], " ", "theta"}], "p"], "-", 
      RowBox[{"eta", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "0.1`"}], "+", "p"}], ")"}], " ", 
       SuperscriptBox["p", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "eta"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[InvisibleSpace]", "+", 
         RowBox[{
          SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["p", 
        RowBox[{"-", "eta"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[InvisibleSpace]", "+", 
         RowBox[{
          SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}]}], 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.5989428417128773`*^9, 3.5989428812008257`*^9}, 
   3.5995379730602446`*^9, 3.5998821665142117`*^9, 3.5998870043819647`*^9, 
   3.5998935122309647`*^9, 3.6010530902051*^9, 3.6010931219606194`*^9, 
   3.601100112172861*^9, 3.6011171300246305`*^9, {3.6011220062482696`*^9, 
   3.601122026386283*^9}, 3.6011220841880627`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptheta", " ", "=", "1.0"}], ";", " ", 
  RowBox[{"pp", "=", "0.2"}], ";", " ", 
  RowBox[{"ppbar", " ", "=", "1.0"}], ";", " ", 
  RowBox[{"peta", " ", "=", " ", "2.0"}], ";", 
  RowBox[{"pgamma", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Demand", "[", 
  RowBox[{"ptheta", ",", " ", "pp", ",", " ", "ppbar", ",", " ", "peta"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"InverseDemand", "[", 
  RowBox[{"ptheta", ",", " ", 
   RowBox[{"Demand", "[", 
    RowBox[{"ptheta", ",", " ", "pp", ",", " ", "ppbar", ",", " ", "peta"}], 
    "]"}], ",", " ", "peta"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Profit", "[", 
  RowBox[{"ptheta", ",", "pp", ",", "ppbar", ",", "peta"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CdfTheta", "[", 
  RowBox[{"0.5", ",", "pgamma"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5989379912248774`*^9, 3.598938018343589*^9}, {
  3.5989381201867723`*^9, 3.5989381320269556`*^9}, {3.598938318577609*^9, 
  3.598938326146366*^9}, {3.5989415867273912`*^9, 3.5989415885345716`*^9}, {
  3.6011188731076746`*^9, 3.6011190260906744`*^9}}],

Cell[BoxData["25.999999999999996`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.601093125355899*^9, 3.601100112246868*^9, 3.6011171323538632`*^9, {
   3.6011190146736746`*^9, 3.6011190274896746`*^9}, 3.6011220298216267`*^9, 
   3.601122087135358*^9}],

Cell[BoxData["0.2`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.601093125355899*^9, 3.601100112246868*^9, 3.6011171323538632`*^9, {
   3.6011190146736746`*^9, 3.6011190274896746`*^9}, 3.6011220298216267`*^9, 
   3.6011220871373577`*^9}],

Cell[BoxData["2.5999999999999996`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.601093125355899*^9, 3.601100112246868*^9, 3.6011171323538632`*^9, {
   3.6011190146736746`*^9, 3.6011190274896746`*^9}, 3.6011220298216267`*^9, 
   3.601122087138358*^9}],

Cell[BoxData["0.7071067811865476`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.601093125355899*^9, 3.601100112246868*^9, 3.6011171323538632`*^9, {
   3.6011190146736746`*^9, 3.6011190274896746`*^9}, 3.6011220298216267`*^9, 
   3.601122087140358*^9}]
}, Open  ]],

Cell["\<\
Remark: When eta increases, demand sensitivity increases => argmax of profit \
decreases... but max of profit increases (argmax closer to 0 in which demand \
goes to infinity)\
\>", "Text",
 CellChangeTimes->{{3.6010931636504107`*^9, 3.601093229385256*^9}, {
  3.6010944058970394`*^9, 3.601094467472089*^9}, {3.601094559327326*^9, 
  3.60109456911085*^9}, {3.6010947214702053`*^9, 3.6010947235505915`*^9}, {
  3.6011206635730157`*^9, 3.6011206648201404`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Demand", "[", 
           RowBox[{"0.3", ",", " ", "ip", ",", " ", "ppbar", ",", "ieta"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ip", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ieta", ",", " ", "2", ",", "5"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "                            ", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Profit", "[", 
           RowBox[{"0.3", ",", " ", "ip", ",", " ", "ppbar", ",", "ieta"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ip", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ieta", ",", " ", "2", ",", "5"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "                            ", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"CdfTheta", "[", 
           RowBox[{"itheta", ",", " ", "igamma"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"itheta", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"igamma", ",", "0.5", ",", "1.5"}], "}"}]}], "]"}]}], "}"}], 
    "}"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5998949806439643`*^9, 3.599895118106964*^9}, 
   3.5998951843109646`*^9, {3.599895216052964*^9, 3.599895360778964*^9}, {
   3.599895413927964*^9, 3.5998954208879642`*^9}, {3.601093232636401*^9, 
   3.601093269307849*^9}, {3.6010933990747814`*^9, 3.6010933993949795`*^9}, {
   3.6010937186158075`*^9, 3.6010939125203543`*^9}, {3.6010939794329815`*^9, 
   3.6010939826551113`*^9}, {3.601094019310548*^9, 3.601094087366919*^9}, {
   3.6010942521745605`*^9, 3.6010942601258583`*^9}, {3.601119067511675*^9, 
   3.6011190738956747`*^9}, {3.60112197064571*^9, 3.601121998918537*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     TagBox[
      FormBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`ieta$$ = 2, Typeset`show$$ = True, 
         Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
         Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
         "\"untitled\"", Typeset`specs$$ = {{
           Hold[$CellContext`ieta$$], 2, 5}}, Typeset`size$$ = {
         219., {70., 75.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`ieta$2041127$$ = 0}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          1, TraditionalForm, "Variables" :> {$CellContext`ieta$$ = 2}, 
           "ControllerVariables" :> {
             Hold[$CellContext`ieta$$, $CellContext`ieta$2041127$$, 0]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Plot[
             $CellContext`Demand[
             0.3, $CellContext`ip, $CellContext`ppbar, $CellContext`ieta$$], \
{$CellContext`ip, 0, 1}], "Specifications" :> {{$CellContext`ieta$$, 2, 5}}, 
           "Options" :> {}, "DefaultOptions" :> {}],
          ImageSizeCache->{268., {114., 119.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       TraditionalForm],
      Manipulate`InterpretManipulate[1]], {193.5, -189.}, {
     Center, Center}, {360., 360.}], InsetBox[
     TagBox[
      FormBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`ieta$$ = 2, Typeset`show$$ = True, 
         Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
         Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
         "\"untitled\"", Typeset`specs$$ = {{
           Hold[$CellContext`ieta$$], 2, 5}}, Typeset`size$$ = {
         219., {64., 67.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`ieta$2041144$$ = 0}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          1, TraditionalForm, "Variables" :> {$CellContext`ieta$$ = 2}, 
           "ControllerVariables" :> {
             Hold[$CellContext`ieta$$, $CellContext`ieta$2041144$$, 0]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Plot[
             $CellContext`Profit[
             0.3, $CellContext`ip, $CellContext`ppbar, $CellContext`ieta$$], \
{$CellContext`ip, 0, 1}], "Specifications" :> {{$CellContext`ieta$$, 2, 5}}, 
           "Options" :> {}, "DefaultOptions" :> {}],
          ImageSizeCache->{268., {107., 112.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       TraditionalForm],
      Manipulate`InterpretManipulate[1]], {580.5, -189.}, {
     Center, Center}, {360., 360.}], InsetBox[
     TagBox[
      FormBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`igamma$$ = 0.5, Typeset`show$$ = True, 
         Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
         Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
         "\"untitled\"", Typeset`specs$$ = {{
           Hold[$CellContext`igamma$$], 0.5, 1.5}}, Typeset`size$$ = {
         226., {71., 76.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`igamma$2041161$$ = 0}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          1, TraditionalForm, "Variables" :> {$CellContext`igamma$$ = 0.5}, 
           "ControllerVariables" :> {
             Hold[$CellContext`igamma$$, $CellContext`igamma$2041161$$, 0]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Plot[
             $CellContext`CdfTheta[$CellContext`itheta, \
$CellContext`igamma$$], {$CellContext`itheta, 0, 1}], 
           "Specifications" :> {{$CellContext`igamma$$, 0.5, 1.5}}, 
           "Options" :> {}, "DefaultOptions" :> {}],
          ImageSizeCache->{289., {115., 120.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       TraditionalForm],
      Manipulate`InterpretManipulate[1]], {967.5, -189.}, {
     Center, Center}, {360., 360.}]}, {}},
  ContentSelectable->True,
  ImageSize->{583., Automatic},
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{3.6011171348401117`*^9, 3.6011190779286747`*^9, 
  3.60112203225187*^9, 3.601122090779722*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["First order condition (Privacy)", "Subsubtitle",
 CellChangeTimes->{{3.598943838678564*^9, 3.598943849462642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FirstOrderCondition", "[", 
   RowBox[{"p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_"}], 
   "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeProfit", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}], "*", 
     RowBox[{"PdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}]}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"FirstOrderCondition", "[", 
   RowBox[{"p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma"}], "]"}],
   "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5989392435710993`*^9, 3.598939358184559*^9}, {
   3.598939431356876*^9, 3.5989395598257217`*^9}, 3.5989396221489534`*^9, {
   3.598939661140852*^9, 3.598939665092247*^9}, {3.598940427377468*^9, 
   3.598940462114941*^9}, {3.5989417311658335`*^9, 3.59894178033575*^9}, {
   3.598942878214527*^9, 3.5989429688575907`*^9}, {3.601094758049591*^9, 
   3.601094760273074*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {
     RowBox[{"\[Piecewise]", GridBox[{
        {
         RowBox[{
          FractionBox["1", 
           RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma"}]], 
          RowBox[{"0.1`", " ", 
           SuperscriptBox["p", 
            RowBox[{
             RowBox[{"-", "1.`"}], "-", 
             RowBox[{"1.`", " ", "eta"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{"eta", "+", 
             RowBox[{"eta", " ", "gamma"}], "+", 
             RowBox[{"10.`", " ", "p"}], "-", 
             RowBox[{"10.`", " ", "eta", " ", "p"}], "+", 
             RowBox[{"10.`", " ", "gamma", " ", "p"}], "-", 
             RowBox[{"10.`", " ", "eta", " ", "gamma", " ", "p"}], "+", 
             RowBox[{"10.`", " ", "gamma", " ", 
              SuperscriptBox["p", 
               RowBox[{"1.`", "\[InvisibleSpace]", "+", "eta"}]]}]}], 
            ")"}]}]}], 
         RowBox[{
          RowBox[{"Re", "[", "gamma", "]"}], ">", "0.`"}]},
        {
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"0.1`", " ", "gamma", " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1.`"}], "-", 
              RowBox[{"1.`", " ", "eta"}]}]], " ", 
            SuperscriptBox["theta", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "gamma"}]], " ", 
            RowBox[{"(", 
             RowBox[{"eta", "+", 
              RowBox[{"10.`", " ", "p"}], "-", 
              RowBox[{"10.`", " ", "eta", " ", "p"}], "+", 
              RowBox[{"10.`", " ", 
               SuperscriptBox["p", 
                RowBox[{"1.`", "\[InvisibleSpace]", "+", "eta"}]], " ", 
               "theta"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"theta", ",", "0.`", ",", "1.`"}], "}"}], ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "-", 
               RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}], "&&", 
             RowBox[{
              RowBox[{"Re", "[", "gamma", "]"}], "\[LessEqual]", 
              "0.`"}]}]}]}], "]"}], 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->False,
          DeletionWarning->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}], 
     RowBox[{
      RowBox[{"p", "-", 
       RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}]},
    {"0.`", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.598939481074847*^9, 3.598939486616401*^9}, {
   3.598939518746614*^9, 3.5989395613598747`*^9}, 3.598939625590297*^9, 
   3.5989396669874363`*^9, {3.598940430139744*^9, 3.5989404425229826`*^9}, 
   3.598940763352062*^9, 3.598941605405259*^9, {3.598941737456463*^9, 
   3.59894178123884*^9}, {3.598942935833288*^9, 3.5989429710398088`*^9}, 
   3.599537977872984*^9, 3.599882177048234*^9, 3.5998870121319647`*^9, 
   3.5998935271109643`*^9, 3.6010531350059695`*^9, 3.6010946498426695`*^9, {
   3.6010947709292536`*^9, 3.6010947933221817`*^9}, 3.60110011736438*^9, {
   3.6011171456241903`*^9, 3.601117158677495*^9}, 3.6011191051066747`*^9, 
   3.601122035413186*^9, 3.60112209746539*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp", "=", "0.2"}], ";", 
  RowBox[{"ppbar", "=", "1.0"}], ";", " ", 
  RowBox[{"peta", "=", "2.0"}], ";", " ", 
  RowBox[{"pgamma", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FirstOrderCondition", "[", 
  RowBox[{"pp", ",", " ", "ppbar", ",", " ", "peta", ",", " ", "pgamma"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6011191210106745`*^9, 3.6011191938546743`*^9}}],

Cell[BoxData["0.3333333333333297`"], "Output",
 CellChangeTimes->{{3.598939481074847*^9, 3.598939486616401*^9}, {
   3.598939518746614*^9, 3.5989395613598747`*^9}, 3.598939625590297*^9, 
   3.5989396669874363`*^9, {3.598940430139744*^9, 3.5989404425229826`*^9}, 
   3.598940763352062*^9, 3.598941605405259*^9, {3.598941737456463*^9, 
   3.59894178123884*^9}, {3.598942935833288*^9, 3.5989429710398088`*^9}, 
   3.599537977872984*^9, 3.599882177048234*^9, 3.5998870121319647`*^9, 
   3.5998935271109643`*^9, 3.6010531350059695`*^9, 3.60109464991872*^9, 
   3.601094772561341*^9, 3.6011001176924124`*^9, {3.6011191697386746`*^9, 
   3.601119181775675*^9}, 3.601122104175061*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results: Profit, CS, Welfare (Privacy)", "Subsubtitle",
 CellChangeTimes->{{3.598941419983719*^9, 3.5989414228960094`*^9}, {
  3.598941474082128*^9, 3.5989414854902687`*^9}, {3.601112823520023*^9, 
  3.6011128257762485`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpectedTheta", "[", "gamma_", "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"theta", "*", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"CdfTheta", "[", 
        RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", " ", "theta"}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedProfit", "[", 
   RowBox[{"p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_"}], 
   "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Profit", "[", 
      RowBox[{"theta", ",", "p", ",", "pbar", ",", "eta"}], "]"}], "*", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"CdfTheta", "[", 
        RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", " ", "theta"}], 
      "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedConsumerSurplus", "[", 
   RowBox[{"theta_", ",", " ", "qstar_", ",", " ", "eta_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"InverseDemand", "[", 
     RowBox[{"theta", ",", " ", "q", ",", " ", "eta"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"q", ",", " ", "0", ",", " ", "qstar"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"ExpectedProfit", "[", 
   RowBox[{"p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma"}], "]"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.5989405052002497`*^9, 3.598940701976925*^9}, {
  3.59894079833356*^9, 3.5989409393626614`*^9}, {3.598941023830107*^9, 
  3.59894102426315*^9}, {3.5989410862973533`*^9, 3.598941087288452*^9}, {
  3.5989418268023963`*^9, 3.598941846354351*^9}, {3.601094687226592*^9, 
  3.601094688777626*^9}, {3.601094776932273*^9, 3.6010947875063076`*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {
     RowBox[{"\[Piecewise]", GridBox[{
        {
         FractionBox[
          RowBox[{"0.1`", " ", 
           SuperscriptBox["p", 
            RowBox[{
             RowBox[{"-", "1.`"}], " ", "eta"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1.`"}], "+", 
             RowBox[{"10.`", " ", "p"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma", "+", 
             RowBox[{"gamma", " ", 
              SuperscriptBox["p", "eta"]}]}], ")"}]}], 
          RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma"}]], 
         RowBox[{
          RowBox[{"Re", "[", "gamma", "]"}], ">", "0.`"}]},
        {
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"0.1`", " ", "gamma", " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1.`"}], " ", "eta"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", 
              RowBox[{"10.`", " ", "p"}]}], ")"}], " ", 
            SuperscriptBox["theta", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "gamma"}]], " ", 
            RowBox[{"(", 
             RowBox[{"1.`", "\[InvisibleSpace]", "+", 
              RowBox[{
               SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"theta", ",", "0.`", ",", "1.`"}], "}"}], ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "-", 
               RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}], "&&", 
             RowBox[{
              RowBox[{"Re", "[", "gamma", "]"}], "\[LessEqual]", 
              "0.`"}]}]}]}], "]"}], 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->False,
          DeletionWarning->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}], 
     RowBox[{
      RowBox[{"p", "-", 
       RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}]},
    {"0.`", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9, 3.5995379807950053`*^9, 3.599882178931491*^9, 
   3.5998870139049644`*^9, 3.5998935288549643`*^9, 3.601053151339857*^9, 
   3.6010946566482077`*^9, 3.6010946968049774`*^9, 3.6010947885660233`*^9, 
   3.6011001194105844`*^9, {3.601117148370465*^9, 3.6011171531479425`*^9}, 
   3.601122111038748*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp", "=", "0.2"}], ";", 
  RowBox[{"ppbar", "=", "1.0"}], ";", " ", 
  RowBox[{"peta", "=", "2.0"}], ";", " ", 
  RowBox[{"pgamma", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedProfit", "[", 
   RowBox[{"pp", ",", " ", "ppbar", ",", " ", "peta", ",", " ", "pgamma"}], 
   "]"}], " ", "\[Equal]", " ", 
  RowBox[{"Profit", "[", 
   RowBox[{
    RowBox[{"ExpectedTheta", "[", "pgamma", "]"}], ",", " ", "pp", ",", " ", 
    "ppbar", ",", " ", "peta"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExpectedConsumerSurplus", "[", 
  RowBox[{
   RowBox[{"ExpectedTheta", "[", "pgamma", "]"}], ",", 
   RowBox[{"Demand", "[", 
    RowBox[{
     RowBox[{"ExpectedTheta", "[", "pgamma", "]"}], ",", " ", "pp", ",", " ", 
     "ppbar", ",", " ", "peta"}], "]"}], ",", " ", "peta"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6010947816734343`*^9, 3.6010947859042377`*^9}, {
  3.601114385529208*^9, 3.6011144031299677`*^9}, {3.6011191979346743`*^9, 
  3.6011192949046745`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9, 3.5995379807950053`*^9, 3.599882178931491*^9, 
   3.5998870139049644`*^9, 3.5998935288549643`*^9, 3.601053151339857*^9, 
   3.6010946566802273`*^9, 3.6010947909125757`*^9, 3.6011001194675903`*^9, 
   3.601114405220177*^9, 3.6011171661292405`*^9, 3.6011192954636745`*^9, 
   3.601122115976241*^9}],

Cell[BoxData["10.`"], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9, 3.5995379807950053`*^9, 3.599882178931491*^9, 
   3.5998870139049644`*^9, 3.5998935288549643`*^9, 3.601053151339857*^9, 
   3.6010946566802273`*^9, 3.6010947909125757`*^9, 3.6011001194675903`*^9, 
   3.601114405220177*^9, 3.6011171661292405`*^9, 3.6011192954636745`*^9, 
   3.601122116510295*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation of equilibria: Tests (Privacy)", "Subsubtitle",
 CellChangeTimes->{{3.598942016165331*^9, 3.5989420462623405`*^9}, {
  3.5998934651719646`*^9, 3.5998934736349645`*^9}, {3.601123289026535*^9, 
  3.6011233013467665`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ppbar", "=", "1.0"}], ";", " ", 
  RowBox[{"peta", "=", "2.0"}], ";", " ", 
  RowBox[{"pgamma", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Quiet", "[", 
  RowBox[{"NSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FirstOrderCondition", "[", 
      RowBox[{"p", ",", " ", "ppbar", ",", " ", "peta", ",", " ", "pgamma"}], 
      "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", "p"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5989418839861145`*^9, 3.5989419391716323`*^9}, {
   3.5989489923838825`*^9, 3.5989490205937033`*^9}, 3.599882733765378*^9, {
   3.6010930949996614`*^9, 3.6010931181881166`*^9}, {3.6010958750618205`*^9, 
   3.6010958786131873`*^9}, {3.6011194132486744`*^9, 3.6011194278076744`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"1.`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.`", " ", 
       RowBox[{
        TagBox[
         SuperscriptBox["UnitStep", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]],
         {InverseFunction, 1, 1},
         Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"-", "1.8245148778558737`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.20277939461513023`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "1.6217354832407433`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5989490132279673`*^9, 3.5989626276184206`*^9, 3.5998821866956654`*^9, 
   3.599882739281068*^9, 3.599887022073964*^9, 3.5998935329519644`*^9, 
   3.599894454455964*^9, 3.6010531588058343`*^9, {3.6010930991323986`*^9, 
   3.6010931123142085`*^9}, 3.601094803994296*^9, 3.6010951778315334`*^9, 
   3.601095888050479*^9, 3.601100119838627*^9, 3.60111716882451*^9, 
   3.6011194305356746`*^9, 3.601122119331577*^9}]
}, Open  ]],

Cell["\<\
Solving for various gamma (higher gamma: higher density of consumers towards \
gamma value 1 and thus higher profit)\
\>", "Text",
 CellChangeTimes->{{3.599538430299038*^9, 3.599538529280962*^9}, {
  3.6010953305447917`*^9, 3.6010953353850183`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"igamma", "=", "0.5"}], ",", 
    RowBox[{"igamma", "\[LessEqual]", "1.5"}], ",", 
    RowBox[{"igamma", "+=", "0.5"}], ",", "\[IndentingNewLine]", 
    "                    ", 
    RowBox[{
     RowBox[{"arsol", " ", "=", "  ", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FirstOrderCondition", "[", 
          RowBox[{
          "p", " ", ",", " ", "ppbar", ",", " ", "peta", ",", " ", "igamma"}],
           "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", "p"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "                    ", 
     RowBox[{"sol", " ", "=", " ", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"p", "/.", "arsol"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
           RowBox[{"#", "\[LessEqual]", " ", "1"}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "                    ", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"sol", ",", " ", 
        RowBox[{"ExpectedProfit", "[", 
         RowBox[{
         "sol", ",", " ", "ppbar", ",", " ", "peta", ",", " ", "igamma"}], 
         "]"}]}], "}"}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.601094852456605*^9, 3.6010948690076523`*^9}, {
   3.601094899351886*^9, 3.6010949776470833`*^9}, {3.6011194344636745`*^9, 
   3.6011194672456746`*^9}, {3.6011210382114754`*^9, 3.601121233546007*^9}, {
   3.601121268124465*^9, 3.6011213491995716`*^9}, 3.6011214151381645`*^9, {
   3.6011219467413197`*^9, 3.6011219541490602`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20277939461513023`", ",", "2.533790128240499`"}], "}"}]], "Print",
 CellChangeTimes->{{3.601121333443996*^9, 3.601121351026754*^9}, 
   3.6011214167893295`*^9, 3.6011221240140452`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20426115523299948`", ",", "2.55104259200335`"}], "}"}]], "Print",
 CellChangeTimes->{{3.601121333443996*^9, 3.601121351026754*^9}, 
   3.6011214167893295`*^9, 3.601122124084052*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20518292468904759`", ",", "2.561514583344216`"}], "}"}]], "Print",
 CellChangeTimes->{{3.601121333443996*^9, 3.601121351026754*^9}, 
   3.6011214167893295`*^9, 3.6011221242540693`*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Solving for various eta (higher eta: higher demand sensitivity incudes lower \
prices, but profit increases)\
\>", "Text",
 CellChangeTimes->{{3.599538552313297*^9, 3.5995385717212114`*^9}, {
  3.6010949969719663`*^9, 3.601095059650756*^9}, {3.601095155066347*^9, 
  3.601095156250147*^9}, {3.6010953206251783`*^9, 3.6010953263690033`*^9}, {
  3.601123166654299*^9, 3.6011231908147144`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ieta", "=", "2.0"}], ",", 
    RowBox[{"ieta", "\[LessEqual]", "3.0"}], ",", 
    RowBox[{"ieta", "+=", "0.5"}], ",", "\[IndentingNewLine]", 
    "                    ", 
    RowBox[{
     RowBox[{"arsol", " ", "=", "  ", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FirstOrderCondition", "[", 
          RowBox[{
          "p", " ", ",", " ", "ppbar", ",", " ", "ieta", ",", " ", "pgamma"}],
           "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", "p"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "                    ", 
     RowBox[{"sol", " ", "=", " ", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"p", "/.", "arsol"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
           RowBox[{"#", "\[LessEqual]", " ", "1"}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "                    ", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"sol", ",", " ", 
        RowBox[{"ExpectedProfit", "[", 
         RowBox[{
         "sol", ",", " ", "ppbar", ",", " ", "ieta", ",", " ", "pgamma"}], 
         "]"}]}], "}"}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6011213938730383`*^9, 3.6011214198416348`*^9}, {
  3.6011219354281883`*^9, 3.6011219421648617`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20277939461513023`", ",", "2.533790128240499`"}], "}"}]], "Print",
 CellChangeTimes->{3.6011214219098415`*^9, 3.601122128622506*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.16709042471177077`", ",", "5.901068021676773`"}], "}"}]], "Print",
 CellChangeTimes->{3.6011214219098415`*^9, 3.601122128796523*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.15008456543318968`", ",", "14.831495565124317`"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.6011214219098415`*^9, 3.60112212896554*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Order statistics (Disclosure)\
\>", "Subsubtitle",
 CellChangeTimes->{{3.598943000248729*^9, 3.598943003640068*^9}, 
   3.6010959351889043`*^9, {3.6011232690735397`*^9, 3.6011232714897814`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PdfOrderStat", "[", 
     RowBox[{"x_", ",", "k_", ",", "n_", ",", " ", "gamma_"}], "]"}], ":=", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "!"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "!"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "k"}], ")"}], "!"}]}], ")"}]}], "*", 
     RowBox[{
      RowBox[{"CdfTheta", "[", 
       RowBox[{"x", ",", " ", "gamma"}], "]"}], "^", 
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"CdfTheta", "[", 
         RowBox[{"x", ",", " ", "gamma"}], "]"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "k"}], ")"}]}], "*", 
     RowBox[{"PdfTheta", "[", 
      RowBox[{"x", ",", " ", "gamma"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CdfOrderStat", "[", 
     RowBox[{"y_", ",", "k_", ",", "n_", ",", "gamma_"}], "]"}], " ", "=", 
    " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"PdfOrderStat", "[", 
       RowBox[{"x", ",", "k", ",", "n", ",", "gamma"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "y"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5989430116388683`*^9, 3.598943068715575*^9}, {
  3.5989431007967834`*^9, 3.598943237650467*^9}, {3.598943270003702*^9, 
  3.598943303605062*^9}, {3.598943570719771*^9, 3.598943633208019*^9}}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "y"], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"n", "!"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{"x", "<", "0"}]},
           {"1", 
            RowBox[{"x", ">", "1"}]},
           {
            SuperscriptBox["x", "gamma"], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->False,
             DeletionWarning->True]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}]}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "k"}], "+", "n"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Piecewise]", GridBox[{
          {"0", 
           RowBox[{"x", "<", "0"}]},
          {"1", 
           RowBox[{"x", ">", "1"}]},
          {
           SuperscriptBox["x", "gamma"], 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->False,
            DeletionWarning->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}]], " ", 
     RowBox[{"(", 
      RowBox[{"\[Piecewise]", GridBox[{
         {"0", 
          RowBox[{"x", "<", "0"}]},
         {
          RowBox[{"gamma", " ", 
           SuperscriptBox["x", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "gamma"}]]}], 
          RowBox[{"0", "<", "x", "<", "1"}]},
         {"0", 
          RowBox[{"x", ">", "1"}]},
         {"Indeterminate", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->False,
           DeletionWarning->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "k"}], ")"}], "!"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "k"}], "+", "n"}], ")"}], "!"}]}]], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Output",
 CellChangeTimes->{3.5989436348761854`*^9, 3.59988229501688*^9, 
  3.5998870280209646`*^9, 3.599893590337964*^9, 3.601095449429541*^9, 
  3.6011001205867023`*^9, 3.601117173565984*^9, 3.6011221321838617`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6011197041500826`*^9, 3.6011197050751753`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pk", " ", "=", "3"}], ";", " ", 
    RowBox[{"pn", "=", "4"}], ";", " ", 
    RowBox[{"pgamma", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"PdfOrderStat", "[", 
         RowBox[{"x", ",", "pk", ",", "pn", ",", "pgamma"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "0.5"}], "}"}]}], "]"}], ",", 
      RowBox[{"CdfOrderStat", "[", 
       RowBox[{"0.5", ",", "pk", ",", "pn", ",", "pgamma"}], "]"}]}], "}"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"PdfOrderStat", "[", 
         RowBox[{"x", ",", 
          RowBox[{"pk", "-", "1"}], ",", "pn", ",", "pgamma"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "0.5"}], "}"}]}], "]"}], ",", 
      RowBox[{"CdfOrderStat", "[", 
       RowBox[{"0.5", ",", 
        RowBox[{"pk", "-", "1"}], ",", "pn", ",", "pgamma"}], "]"}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5989431662183247`*^9, 3.598943182510954*^9}, {
  3.5989432413458366`*^9, 3.5989432535860605`*^9}, {3.598943326037305*^9, 
  3.5989433275244536`*^9}, {3.598943700210718*^9, 3.5989437796376605`*^9}, {
  3.598950105912225*^9, 3.5989501061672497`*^9}, {3.6010954125319233`*^9, 
  3.6010954366530194`*^9}, {3.601119706788347*^9, 3.601119786615329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6642135623730951`", ",", "0.6642135623730951`"}], "}"}]], "Print",
 CellChangeTimes->{{3.6010954372403927`*^9, 3.601095451712041*^9}, 
   3.601100120696713*^9, 3.601119788601527*^9, 3.6011221378004236`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9215728752538097`", ",", "0.9215728752538097`"}], "}"}]], "Print",
 CellChangeTimes->{{3.6010954372403927`*^9, 3.601095451712041*^9}, 
   3.601100120696713*^9, 3.601119788601527*^9, 3.6011221378784313`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pk", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"pn", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"CdfTheta", "[", 
     RowBox[{"0.4", ",", "pgamma"}], "]"}], ",", 
    RowBox[{"CdfOrderStat", "[", 
     RowBox[{"0.4", ",", "pk", ",", "pn", ",", "pgamma"}], "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"CdfOrderStat", "[", 
     RowBox[{"0.4", ",", 
      RowBox[{"pk", "+", "1"}], ",", 
      RowBox[{"pn", "+", "1"}], ",", "pgamma"}], "]"}], ",", " ", 
    RowBox[{"CdfOrderStat", "[", 
     RowBox[{"0.4", ",", "pk", ",", 
      RowBox[{"pn", "+", "1"}], ",", "pgamma"}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.598949731200757*^9, 3.5989498915677924`*^9}, {
  3.5989500993195653`*^9, 3.5989501014317765`*^9}, {3.5989501586174946`*^9, 
  3.598950202858918*^9}, {3.5989502683974714`*^9, 3.598950280541686*^9}, {
  3.5989503138230133`*^9, 3.598950316559287*^9}, {3.601112106967375*^9, 
  3.6011121934030175`*^9}, {3.6011198043911057`*^9, 3.601119860089675*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6324555320336759`", ",", "0.6324555320336759`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.601112127089387*^9, {3.601112165934271*^9, 3.601112193966074*^9}, 
   3.601119861104777*^9, 3.6011221432189655`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.4`", ",", "0.8649110640673519`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.601112127089387*^9, {3.601112165934271*^9, 3.601112193966074*^9}, 
   3.601119861104777*^9, 3.6011221432889724`*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Reading (General: Proba that the kth highest draw among n is below y)
With gamma as 0.5 and only one draw, the probability to draw a theta lower \
than 0.4 is c. 0.63. 
With the same gamma and two draws: the proba that the highest of both (the \
2nd of 2) is below 0.4 is 0.4 (<0.63) and the proba that the lowest (the 1st \
of 2) is below 0.4 is c. 0.86.\
\>", "Text",
 CellChangeTimes->{{3.5989499164792833`*^9, 3.5989500844850817`*^9}, {
  3.5989501417998133`*^9, 3.598950150247658*^9}, {3.598950184585091*^9, 
  3.5989502628279147`*^9}, {3.598950300221654*^9, 3.5989503066212935`*^9}, {
  3.601095488496566*^9, 3.6010955296720185`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

First order condition (Disclosure)\
\>", "Subsubtitle",
 CellChangeTimes->{{3.598943824422138*^9, 3.5989438565343494`*^9}, 
   3.601095800821326*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FirstOrderConditionDisclosure", "[", 
   RowBox[{
   "p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_", ",", "k_", 
    ",", "n_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeProfit", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}], "*", 
     RowBox[{"PdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}], "*", " ", 
     RowBox[{"CdfOrderStat", "[", 
      RowBox[{"theta", ",", "k", ",", "n", ",", "gamma"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"FirstOrderConditionDisclosure", "[", 
   RowBox[{
   "p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma", ",", "k", ",", 
    "n"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.598943859176614*^9, 3.598943940956791*^9}, {
  3.598944023440038*^9, 3.598944026351329*^9}, {3.5989448769103765`*^9, 
  3.598944898254511*^9}, {3.5989512837309947`*^9, 3.5989512852991514`*^9}, {
  3.6010958258950415`*^9, 3.6010958395361357`*^9}}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "1"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "theta"], 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"n", "!"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Piecewise]", GridBox[{
              {"0", 
               RowBox[{"x", "<", "0"}]},
              {"1", 
               RowBox[{"x", ">", "1"}]},
              {
               SuperscriptBox["x", "gamma"], 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->False,
                DeletionWarning->True]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{1.}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}]}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "k"}], "+", "n"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Piecewise]", GridBox[{
             {"0", 
              RowBox[{"x", "<", "0"}]},
             {"1", 
              RowBox[{"x", ">", "1"}]},
             {
              SuperscriptBox["x", "gamma"], 
              TagBox["True",
               "PiecewiseDefault",
               AutoDelete->False,
               DeletionWarning->True]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}]], " ", 
        RowBox[{"(", 
         RowBox[{"\[Piecewise]", GridBox[{
            {"Indeterminate", 
             RowBox[{
              RowBox[{"x", "\[Equal]", "0"}], "||", 
              RowBox[{"x", "\[Equal]", "1"}]}]},
            {
             RowBox[{"gamma", " ", 
              SuperscriptBox["x", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "gamma"}]]}], 
             RowBox[{"0", "<", "x", "<", "1"}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->False,
              DeletionWarning->True]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}]}], 
       RowBox[{
        RowBox[{"Gamma", "[", "k", "]"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"1", "-", "k", "+", "n"}], "]"}]}]], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{"p", ">", "pbar"}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["p", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "eta"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"eta", " ", 
             RowBox[{"(", 
              RowBox[{"0.1`", "\[InvisibleSpace]", "-", 
               RowBox[{"1.`", " ", "p"}]}], ")"}]}], "+", 
            RowBox[{"1.`", " ", "p"}]}], ")"}]}], "+", "theta"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->False,
         DeletionWarning->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"\[Piecewise]", GridBox[{
       {"Indeterminate", 
        RowBox[{
         RowBox[{"theta", "\[Equal]", "0"}], "||", 
         RowBox[{"theta", "\[Equal]", "1"}]}]},
       {
        RowBox[{"gamma", " ", 
         SuperscriptBox["theta", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "gamma"}]]}], 
        RowBox[{"0", "<", "theta", "<", "1"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->False,
         DeletionWarning->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
   RowBox[{"\[DifferentialD]", "theta"}]}]}]], "Output",
 CellChangeTimes->{3.6010958878073163`*^9, 3.601100166981341*^9, 
  3.601117224983125*^9, 3.601122193291972*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Results: Profit, CS, Welfare (Disclosure)\
\>", "Subsubtitle",
 CellChangeTimes->{
  3.601121587749424*^9, 3.6011216184064894`*^9, {3.6011232779224243`*^9, 
   3.601123279617594*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpectedThetaOrder", "[", 
   RowBox[{"k_", ",", " ", "n_", ",", " ", "gamma_"}], "]"}], " ", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"PdfOrderStat", "[", 
      RowBox[{"x", ",", "k", ",", "n", ",", "gamma"}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedProfitOrder", "[", 
   RowBox[{
   "p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "k_", ",", "n_", ",", 
    "gamma_"}], "]"}], "=", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Profit", "[", 
      RowBox[{"x", ",", "p", ",", "pbar", ",", "eta"}], "]"}], "*", 
     RowBox[{"PdfOrderStat", "[", 
      RowBox[{"x", ",", "k", ",", "n", ",", " ", "gamma"}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "1"], 
  RowBox[{
   FractionBox[
    RowBox[{"x", " ", 
     RowBox[{"n", "!"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{"x", "<", "0"}]},
           {"1", 
            RowBox[{"x", ">", "1"}]},
           {
            SuperscriptBox["x", "gamma"], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->False,
             DeletionWarning->True]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}]}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "k"}], "+", "n"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Piecewise]", GridBox[{
          {"0", 
           RowBox[{"x", "<", "0"}]},
          {"1", 
           RowBox[{"x", ">", "1"}]},
          {
           SuperscriptBox["x", "gamma"], 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->False,
            DeletionWarning->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}]], " ", 
     RowBox[{"(", 
      RowBox[{"\[Piecewise]", GridBox[{
         {"0", 
          RowBox[{"x", "<", "0"}]},
         {
          RowBox[{"gamma", " ", 
           SuperscriptBox["x", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "gamma"}]]}], 
          RowBox[{"0", "<", "x", "<", "1"}]},
         {"0", 
          RowBox[{"x", ">", "1"}]},
         {"Indeterminate", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->False,
           DeletionWarning->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "k"}], ")"}], "!"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "k"}], "+", "n"}], ")"}], "!"}]}]], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Output",
 CellChangeTimes->{3.601121604130062*^9, 3.6011216625148997`*^9, 
  3.6011221997546186`*^9}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "1"], 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "k"}], ")"}], "!"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "k"}], "+", "n"}], ")"}], "!"}]}]], 
    RowBox[{
     RowBox[{"n", "!"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Piecewise]", GridBox[{
         {"0", 
          RowBox[{"p", ">", "pbar"}]},
         {
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.1`"}], "+", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"\[Piecewise]", GridBox[{
               {"0", 
                RowBox[{"p", ">", "pbar"}]},
               {
                RowBox[{
                 SuperscriptBox["p", 
                  RowBox[{"-", "eta"}]], "+", "x"}], 
                TagBox["True",
                 "PiecewiseDefault",
                 AutoDelete->False,
                 DeletionWarning->True]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{1.}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.84]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}]}], 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->False,
           DeletionWarning->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{"x", "<", "0"}]},
           {"1", 
            RowBox[{"x", ">", "1"}]},
           {
            SuperscriptBox["x", "gamma"], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->False,
             DeletionWarning->True]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}]}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "k"}], "+", "n"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Piecewise]", GridBox[{
          {"0", 
           RowBox[{"x", "<", "0"}]},
          {"1", 
           RowBox[{"x", ">", "1"}]},
          {
           SuperscriptBox["x", "gamma"], 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->False,
            DeletionWarning->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}]], " ", 
     RowBox[{"(", 
      RowBox[{"\[Piecewise]", GridBox[{
         {"0", 
          RowBox[{"x", "<", "0"}]},
         {
          RowBox[{"gamma", " ", 
           SuperscriptBox["x", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "gamma"}]]}], 
          RowBox[{"0", "<", "x", "<", "1"}]},
         {"0", 
          RowBox[{"x", ">", "1"}]},
         {"Indeterminate", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->False,
           DeletionWarning->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}]}]}], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Output",
 CellChangeTimes->{3.601121604130062*^9, 3.6011216625148997`*^9, 
  3.601122204262069*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pk", " ", "=", " ", "2"}], ";", " ", 
  RowBox[{"pn", " ", "=", " ", "3"}], ";", " ", 
  RowBox[{"pgamma", " ", "=", "0.5"}], ";", " ", 
  RowBox[{"pp", " ", "=", " ", "0.2"}], ";", " ", 
  RowBox[{"ppbar", " ", "=", " ", "1.0"}], ";", " ", 
  RowBox[{"peta", " ", "=", " ", "2.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExpectedThetaOrder", "[", 
  RowBox[{"pk", ",", " ", "pn", ",", " ", "pgamma"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedProfitOrder", "[", 
   RowBox[{
   "pp", ",", " ", "ppbar", ",", "peta", ",", " ", "pk", ",", "pn", ",", 
    "pgamma"}], "]"}], " ", "\[Equal]", " ", 
  RowBox[{"Profit", "[", 
   RowBox[{
    RowBox[{"ExpectedThetaOrder", "[", 
     RowBox[{"pk", ",", " ", "pn", ",", " ", "pgamma"}], "]"}], ",", "pp", 
    ",", " ", "ppbar", ",", " ", "peta"}], "]"}]}]}], "Input"],

Cell[BoxData["0.3`"], "Output",
 CellChangeTimes->{3.6011216253561845`*^9, 3.6011222089475374`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6011216253561845`*^9, 3.601122209020545*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Computation of equilibria: Tests (Disclosure)\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5995383840032053`*^9, 3.5995383950345354`*^9}, {
   3.5998934939219646`*^9, 3.5998934956509647`*^9}, 3.6010958019891043`*^9, 
   3.601120288903552*^9, {3.6011233060832405`*^9, 3.6011233085154834`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp", " ", "=", " ", "0.2"}], ";", " ", 
  RowBox[{"ppbar", " ", "=", " ", "1.0"}], ";", " ", 
  RowBox[{"peta", " ", "=", " ", "2.0"}], ";", " ", 
  RowBox[{"pgamma", " ", "=", " ", "0.5"}], ";", " ", 
  RowBox[{"pk", " ", "=", "4"}], ";", " ", 
  RowBox[{"pn", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FirstOrderConditionDisclosure", "[", 
  RowBox[{
  "pp", ",", "ppbar", ",", "peta", ",", "pgamma", ",", "pk", ",", "pn"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FirstOrderConditionDisclosure", "[", 
     RowBox[{
     "p", ",", " ", "ppbar", ",", "peta", ",", "pgamma", ",", "pn", ",", 
      "pn"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FirstOrderConditionDisclosure", "[", 
     RowBox[{
     "p", ",", " ", "ppbar", ",", "peta", ",", "pgamma", ",", " ", "pk", ",", 
      "pn"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.598944806298316*^9, 3.5989448083615227`*^9}, {
   3.5989448393876247`*^9, 3.598944863019988*^9}, {3.598944906717357*^9, 
   3.598944939390624*^9}, 3.598948824857132*^9, {3.5998870416019645`*^9, 
   3.5998870551229644`*^9}, {3.6010955724765687`*^9, 3.601095577538925*^9}, {
   3.601119876410307*^9, 3.6011199526529307`*^9}}],

Cell[BoxData["0.30303030303029566`"], "Output",
 CellChangeTimes->{{3.5989448236860547`*^9, 3.5989449418918743`*^9}, 
   3.598948827650411*^9, 3.598951294276049*^9, 3.599882304395131*^9, 
   3.5998870563399644`*^9, 3.5998944031349645`*^9, 3.601095579281087*^9, 
   3.6011001674743905`*^9, {3.6011199554382095`*^9, 3.601119967653431*^9}, 
   3.601122216393282*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p", "\[Rule]", "0.20743852834146162`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5989448236860547`*^9, 3.5989449418918743`*^9}, 
   3.598948827650411*^9, 3.598951294276049*^9, 3.599882304395131*^9, 
   3.5998870563399644`*^9, 3.5998944031349645`*^9, 3.601095579281087*^9, 
   3.6011001674743905`*^9, {3.6011199554382095`*^9, 3.601119967653431*^9}, 
   3.601122219234566*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p", "\[Rule]", "0.20430710246268757`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5989448236860547`*^9, 3.5989449418918743`*^9}, 
   3.598948827650411*^9, 3.598951294276049*^9, 3.599882304395131*^9, 
   3.5998870563399644`*^9, 3.5998944031349645`*^9, 3.601095579281087*^9, 
   3.6011001674743905`*^9, {3.6011199554382095`*^9, 3.601119967653431*^9}, 
   3.60112222797244*^9}]
}, Open  ]],

Cell["\<\
Solving for various gamma (higher gamma: higher density of consumers towards \
gamma value 1 and thus higher profit):\
\>", "Text",
 CellChangeTimes->{3.601095699583291*^9, 3.601120067775442*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"igamma", "=", "0.5"}], ",", 
    RowBox[{"igamma", "\[LessEqual]", "1.5"}], ",", 
    RowBox[{"igamma", "+=", "0.5"}], ",", "\[IndentingNewLine]", 
    "                    ", 
    RowBox[{
     RowBox[{"sol", "=", "  ", 
      RowBox[{"p", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstOrderConditionDisclosure", "[", 
           RowBox[{
           "p", ",", " ", "ppbar", ",", "peta", ",", "igamma", ",", "pk", ",",
             "pn"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "                    ", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"sol", ",", " ", 
        RowBox[{"ExpectedProfit", "[", 
         RowBox[{
         "sol", ",", " ", "ppbar", ",", " ", "peta", ",", " ", "igamma"}], 
         "]"}]}], "}"}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6011215274303927`*^9, 3.601121533525002*^9}, {
  3.6011217989105377`*^9, 3.601121805983245*^9}, {3.6011218392005663`*^9, 
  3.601121841264773*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20430710246268757`", ",", "2.533657958871197`"}], "}"}]], "Print",
 CellChangeTimes->{3.6011218168203287`*^9, 3.601121848546501*^9, 
  3.601122371074749*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.2059565591836603`", ",", "2.5508871561247153`"}], "}"}]], "Print",
 CellChangeTimes->{3.6011218168203287`*^9, 3.601121848546501*^9, 
  3.601122374382079*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20677496701101716`", ",", "2.5613811288565453`"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.6011218168203287`*^9, 3.601121848546501*^9, 
  3.6011223842570667`*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Solving for various eta (higher eta: higher demand sensitivity... price \
decreases due to higher sensitivity)\
\>", "Text",
 CellChangeTimes->{
  3.601095712534941*^9, {3.6011200695516195`*^9, 3.6011200891355777`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ieta", "=", "2.0"}], ",", 
    RowBox[{"ieta", "\[LessEqual]", "3.0"}], ",", 
    RowBox[{"ieta", "+=", "0.5"}], ",", "\[IndentingNewLine]", 
    "                   ", 
    RowBox[{
     RowBox[{"sol", "=", "  ", 
      RowBox[{"p", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstOrderConditionDisclosure", "[", 
           RowBox[{
           "p", ",", " ", "ppbar", ",", "ieta", ",", "pgamma", ",", "pk", ",",
             "pn"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "                   ", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"sol", ",", " ", 
        RowBox[{"ExpectedProfit", "[", 
         RowBox[{
         "sol", ",", " ", "ppbar", ",", " ", "ieta", ",", " ", "pgamma"}], 
         "]"}]}], "}"}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.598965280414674*^9, 3.5989652962872605`*^9}, {
  3.5998912216859646`*^9, 3.5998912528189645`*^9}, {3.601120028383503*^9, 
  3.6011200495996246`*^9}, {3.6011217774693937`*^9, 3.6011217811177588`*^9}, {
  3.6011218684974957`*^9, 3.6011218997146177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20430710246268757`", ",", "2.533657958871197`"}], "}"}]], "Print",
 CellChangeTimes->{3.598965321956827*^9, 3.5998825192833915`*^9, 
  3.599887232705964*^9, 3.5998912765139647`*^9, 3.6010957451802344`*^9, 
  3.6011002366643085`*^9, 3.6011200631589804`*^9, 3.6011219058242283`*^9, 
  3.6011223979074316`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1673117052458805`", ",", "5.901048993390106`"}], "}"}]], "Print",
 CellChangeTimes->{3.598965321956827*^9, 3.5998825192833915`*^9, 
  3.599887232705964*^9, 3.5998912765139647`*^9, 3.6010957451802344`*^9, 
  3.6011002366643085`*^9, 3.6011200631589804`*^9, 3.6011219058242283`*^9, 
  3.6011224066553063`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.15012827878442978`", ",", "14.83149181049893`"}], "}"}]], "Print",
 CellChangeTimes->{3.598965321956827*^9, 3.5998825192833915`*^9, 
  3.599887232705964*^9, 3.5998912765139647`*^9, 3.6010957451802344`*^9, 
  3.6011002366643085`*^9, 3.6011200631589804`*^9, 3.6011219058242283`*^9, 
  3.601122415414182*^9}]
}, Open  ]]
}, Open  ]],

Cell["Solving for various k, n", "Text",
 CellChangeTimes->{{3.601123410822713*^9, 3.6011234168383145`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pgamma", " ", "=", " ", "0.5"}], ";", " ", 
  RowBox[{"peta", " ", "=", " ", "2.0"}], ";", " ", 
  RowBox[{"ppbar", " ", "=", " ", "1.0"}], ";", " ", 
  RowBox[{"pn", " ", "=", " ", "10"}], ";", " ", 
  RowBox[{"ark", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"10", ",", "9", ",", "8", ",", "2", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FirstOrderConditionDisclosure", "[", 
     RowBox[{
     "p", ",", " ", "ppbar", ",", "peta", ",", "pgamma", ",", "10", ",", 
      "10"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"arpstardisclo", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"p", "/.", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstOrderConditionDisclosure", "[", 
         RowBox[{
         "p", ",", " ", "ppbar", ",", "peta", ",", "pgamma", ",", "k", ",", 
          "pn"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"k", ",", " ", "ark"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"arprofitdisclo", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ExpectedProfitOrder", "[", 
     RowBox[{
      RowBox[{"arpstardisclo", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", "ppbar", ",", " ", "peta", 
      ",", " ", 
      RowBox[{"ark", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", "pn", ",", "pgamma"}], "]"}],
     ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Dimensions", "[", "ark", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6011234040330343`*^9, 3.6011234063282633`*^9}, {
  3.601124082545879*^9, 3.6011240828019047`*^9}, {3.6011241566282864`*^9, 
  3.6011241594445677`*^9}, {3.6011242337840014`*^9, 3.601124234055028*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p", "\[Rule]", "0.20756701025506616`"}], "}"}]], "Output",
 CellChangeTimes->{3.6011234226498957`*^9, 3.601124088688493*^9, 
  3.6011241641110344`*^9, 3.601124238944517*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.20756701025506616`", ",", "0.20686642708498898`", ",", 
   "0.2062214834549253`", ",", "0.20337934498069057`", ",", 
   "0.20305927672160173`"}], "}"}]], "Output",
 CellChangeTimes->{3.6011234226498957`*^9, 3.601124088688493*^9, 
  3.6011241641110344`*^9, 3.6011242887825003`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.5863166216265263`", ",", "2.5701091072787223`", ",", 
   "2.5556635787012403`", ",", "2.5040088350345044`", ",", 
   "2.5009940486230775`"}], "}"}]], "Output",
 CellChangeTimes->{3.6011234226498957`*^9, 3.601124088688493*^9, 
  3.6011241641110344`*^9, 3.60112428928055*^9}]
}, Open  ]],

Cell["\<\
As the number of auctionned slots increases, proft/bid decreases... \
Disclosure is first profitable (with small k) then privacy is best.\
\>", "Text",
 CellChangeTimes->{{3.601124306870309*^9, 3.601124408698491*^9}, {
  3.6011244387955*^9, 3.6011245319828176`*^9}, {3.601124569840603*^9, 
  3.6011246411387324`*^9}, {3.601124704341052*^9, 3.601124728853503*^9}, {
  3.601124878859502*^9, 3.601124952813897*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Output for privacy\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5998910360639644`*^9, 3.5998910419839644`*^9}, 
   3.6010957976532135`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"igamma", ",", "0.5", ",", "1.5", ",", "0.5"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"ieta", ",", " ", "2.0", ",", " ", "3.0", ",", " ", "0.5"}], 
         "}"}]}], "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arparam", " ", "=", " ", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arresult", "=", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arprofit", " ", "=", " ", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arcsurplus", " ", "=", " ", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Quiet", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"count", " ", "=", " ", 
       RowBox[{"count", " ", "+", " ", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"arsol", " ", "=", " ", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstOrderCondition", "[", 
           RowBox[{
           "p", " ", ",", " ", "ppbar", ",", " ", "ieta", ",", " ", 
            "igamma"}], "]"}], " ", "\[Equal]", " ", "0"}], " ", ",", " ", 
         "p"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"p", "/.", "arsol"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
           RowBox[{"#", "\[LessEqual]", " ", "1"}]}], "&"}]}], "]"}]}], " ", 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arresult", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", 
       RowBox[{"sol", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arparam", "[", 
        RowBox[{"[", "count", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"igamma", ",", "ieta"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arprofit", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", 
       RowBox[{"ExpectedProfit", "[", 
        RowBox[{
         RowBox[{"arresult", "[", 
          RowBox[{"[", "count", "]"}], "]"}], ",", " ", "ppbar", ",", " ", 
         "ieta", ",", " ", "igamma"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"etheta", "=", 
       RowBox[{"ExpectedTheta", "[", "igamma", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"eqstar", " ", "=", 
       RowBox[{"Demand", "[", 
        RowBox[{"etheta", ",", " ", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "ppbar", ",", " ", 
         "ieta"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arcsurplus", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", 
       RowBox[{"ExpectedConsumerSurplus", "[", 
        RowBox[{"etheta", ",", " ", "eqstar", ",", " ", "ieta"}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"igamma", ",", "0.5", ",", "1.5", ",", "0.5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ieta", ",", " ", "2.0", ",", " ", "3.0", ",", " ", "0.5"}], 
     "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5998833342823334`*^9, 3.5998833419754477`*^9}, {
   3.599883382935752*^9, 3.599883389186921*^9}, {3.5998835035431576`*^9, 
   3.599883591759968*^9}, {3.5998839221557374`*^9, 3.5998839581657443`*^9}, {
   3.5998840476984324`*^9, 3.5998841256123753`*^9}, {3.5998841896941*^9, 
   3.5998841938908973`*^9}, 3.5998893619529643`*^9, {3.5998893921579647`*^9, 
   3.5998894176289644`*^9}, {3.5998894893199644`*^9, 3.5998894913199644`*^9}, 
   3.5998895439569645`*^9, {3.5998896934669647`*^9, 3.5998897147629642`*^9}, {
   3.5998914064459643`*^9, 3.5998914347309647`*^9}, {3.5998925280829644`*^9, 
   3.5998926107999644`*^9}, {3.5998926423669643`*^9, 
   3.5998927117379646`*^9}, {3.599892776309964*^9, 3.5998928197149644`*^9}, {
   3.5998929085089645`*^9, 3.5998929378039646`*^9}, {3.5998929961999645`*^9, 
   3.5998930115119643`*^9}, {3.599893086401964*^9, 3.5998932178349648`*^9}, {
   3.601095983615189*^9, 3.60109598808617*^9}, {3.6010961315257964`*^9, 
   3.601096137165556*^9}, 3.6010966185525465`*^9, {3.601120121894853*^9, 
   3.601120211849848*^9}, {3.601121702943942*^9, 3.601121735792227*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Partition", "[", 
  RowBox[{"arparam", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arresult", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arprofit", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arcsurplus", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arresult", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5998834004474444`*^9, 3.5998834037346177`*^9}, {
  3.5998841326970987`*^9, 3.599884150288827*^9}, {3.599890039488964*^9, 
  3.5998900397449646`*^9}, {3.5998930256009645`*^9, 3.5998930258409643`*^9}, {
  3.599893247330964*^9, 3.5998932504339647`*^9}, {3.6010962702191677`*^9, 
  3.6010962706434507`*^9}, {3.601096626272691*^9, 3.601096667849411*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "2.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "3.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.`", ",", "2.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.`", ",", "3.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.5`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.5`", ",", "2.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.5`", ",", "3.`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669075247*^9, 3.6011002849971414`*^9, 
   3.601120234701133*^9, 3.6011224402366643`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.20277939461513023`", ",", "0.16709042471177077`", ",", 
     "0.15008456543318968`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20426115523299948`", ",", "0.1673051675292797`", ",", 
     "0.15012699164137902`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20518292468904759`", ",", "0.16743494997862027`", ",", 
     "0.150152493541279`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669075247*^9, 3.6011002849971414`*^9, 
   3.601120234701133*^9, 3.601122440239664*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.533790128240499`", ",", "5.901068021676773`", ",", 
     "14.831495565124317`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.55104259200335`", ",", "5.912267627441228`", ",", 
     "14.839846526880066`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.561514583344216`", ",", "5.919004627414882`", ",", 
     "14.84486050085002`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669075247*^9, 3.6011002849971414`*^9, 
   3.601120234701133*^9, 3.6011224402406645`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "9.86293505706507`", ",", "24.401774264491458`", ",", 
     "66.59156091219303`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "9.791386902314402`", ",", "24.354808375711382`", ",", 
     "66.55392839603618`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "9.747399804496293`", ",", "24.326496955970182`", ",", 
     "66.5313232770765`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669075247*^9, 3.6011002849971414`*^9, 
   3.601120234701133*^9, 3.601122440241665*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.20277939461513023`", ",", "0.16709042471177077`", ",", 
     "0.15008456543318968`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20426115523299948`", ",", "0.1673051675292797`", ",", 
     "0.15012699164137902`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20518292468904759`", ",", "0.16743494997862027`", ",", 
     "0.150152493541279`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669075247*^9, 3.6011002849971414`*^9, 
   3.601120234701133*^9, 3.6011224402436647`*^9}]
}, Open  ]],

Cell["\<\
Within row: increase in eta i.e. demand price sensitivity decreases optimal \
price but increases profit (and consumer surplus, which is ok if price \
decreases)
Between rows: increase in gamma i.e. shift of weight in customer valuations \
towards higher valuations increases price and profit (decreases consumer \
surplus)\
\>", "Text",
 CellChangeTimes->{{3.599890391849964*^9, 3.5998904493979645`*^9}, {
  3.5998907144849644`*^9, 3.5998908553879642`*^9}, {3.599890950533964*^9, 
  3.599891000705964*^9}, {3.6010963287461863`*^9, 3.601096557462841*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Output for disclosure\
\>", "Subsubtitle",
 CellChangeTimes->{{3.6011131328589535`*^9, 3.6011131443311005`*^9}, {
  3.601120296488311*^9, 3.6011203057842407`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pgamma", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"peta", " ", "=", " ", "2.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppbar", " ", "=", " ", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pn", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ark", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"10", ",", "9", ",", "8", ",", "2", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dimark", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dimensions", "[", "ark", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arresultdisclo", " ", "=", " ", 
   RowBox[{"Range", "[", "dimark", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arprofitdisclo", " ", "=", " ", 
   RowBox[{"Range", "[", "dimark", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arcsurplusdisclo", " ", "=", " ", 
   RowBox[{"Range", "[", "dimark", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.601118628140074*^9, 3.6011186351466722`*^9}, 
   3.601123094491083*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"count", " ", "=", " ", 
        RowBox[{"count", " ", "+", " ", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"arsol", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FirstOrderConditionDisclosure", "[", 
            RowBox[{
            "p", ",", " ", "ppbar", ",", "peta", ",", "pgamma", ",", "i", ",",
              "pn"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"sol", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"p", "/.", "arsol"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
            RowBox[{"#", "\[LessEqual]", " ", "1"}]}], "&"}]}], "]"}]}], " ", 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arresultdisclo", "[", 
         RowBox[{"[", "count", "]"}], "]"}], "=", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arprofitdisclo", "[", 
         RowBox[{"[", "count", "]"}], "]"}], "=", 
        RowBox[{"ExpectedProfitOrder", "[", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", "ppbar", ",", " ", 
          "peta", ",", "i", ",", "pn", ",", " ", "pgamma"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"etheta", "=", 
        RowBox[{"ExpectedThetaOrder", "[", 
         RowBox[{"i", ",", "pn", ",", " ", "pgamma"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"eqstar", " ", "=", 
        RowBox[{"Demand", "[", 
         RowBox[{"etheta", ",", " ", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", "ppbar", ",", " ", 
          "peta"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arcsurplusdisclo", "[", 
         RowBox[{"[", "count", "]"}], "]"}], "=", 
        RowBox[{"ExpectedConsumerSurplus", "[", 
         RowBox[{"etheta", ",", " ", "eqstar", ",", " ", "peta"}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ark"}], "}"}]}], "]"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.601114903179968*^9, 3.6011149138680367`*^9}, {
  3.601114962045854*^9, 3.6011150064952984`*^9}, {3.601115046928342*^9, 
  3.6011150900176497`*^9}, {3.601115126131261*^9, 3.6011154021138563`*^9}, {
  3.601115651034746*^9, 3.6011156532739697`*^9}, {3.6011157072123632`*^9, 
  3.6011157419168334`*^9}, {3.6011157759032316`*^9, 3.601115776656307*^9}, {
  3.6011159215077906`*^9, 3.601115935492189*^9}, {3.601116156476285*^9, 
  3.601116156892327*^9}, {3.6011162143330708`*^9, 3.601116413141949*^9}, {
  3.60111644655229*^9, 3.601116470137648*^9}, {3.601116556378271*^9, 
  3.6011165735139847`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"ark", "\[IndentingNewLine]", "arresultdisclo", "\
\[IndentingNewLine]", "arprofitdisclo", "\[IndentingNewLine]", \
"arcsurplusdisclo"}], "Input",
 CellChangeTimes->{{3.601115884485089*^9, 3.601115909327573*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "9", ",", "8", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.6011159109637365`*^9, 3.6011160333259716`*^9, 
  3.601118604152872*^9, 3.6011186978231344`*^9, 3.6011205828239417`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.20756701025506616`", ",", "0.20686642708498898`", ",", 
   "0.2062214834549253`", ",", "0.20337934498069057`", ",", 
   "0.20305927672160173`"}], "}"}]], "Output",
 CellChangeTimes->{3.6011159109637365`*^9, 3.6011160333259716`*^9, 
  3.601118604152872*^9, 3.6011186978231344`*^9, 3.6011205828259416`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.5863166216265263`", ",", "2.5701091072787223`", ",", 
   "2.5556635787012403`", ",", "2.5040088350345044`", ",", 
   "2.5009940486230775`"}], "}"}]], "Output",
 CellChangeTimes->{3.6011159109637365`*^9, 3.6011160333259716`*^9, 
  3.601118604152872*^9, 3.6011186978231344`*^9, 3.6011205828259416`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "9.635442537531974`", ",", "9.668074361715158`", ",", "9.698310605146764`", 
   ",", "9.833840305611593`", ",", "9.849340706270905`"}], "}"}]], "Output",
 CellChangeTimes->{3.6011159109637365`*^9, 3.6011160333259716`*^9, 
  3.601118604152872*^9, 3.6011186978231344`*^9, 3.6011205828269415`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1904, 1065},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 123, 1, 101, "Title"],
Cell[693, 25, 138, 1, 33, "Subsubtitle"],
Cell[CellGroupData[{
Cell[856, 30, 3140, 86, 132, "Input"],
Cell[3999, 118, 1313, 35, 75, "Output"],
Cell[5315, 155, 1897, 52, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7249, 212, 1112, 23, 112, "Input"],
Cell[8364, 237, 588, 8, 31, "Output"],
Cell[8955, 247, 575, 8, 31, "Output"],
Cell[9533, 257, 588, 8, 31, "Output"],
Cell[10124, 267, 588, 8, 31, "Output"]
}, Open  ]],
Cell[10727, 278, 469, 8, 49, "Text"],
Cell[CellGroupData[{
Cell[11221, 290, 2130, 48, 92, "Input"],
Cell[13354, 340, 5671, 111, 215, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19062, 456, 120, 1, 33, "Subsubtitle"],
Cell[CellGroupData[{
Cell[19207, 461, 1144, 25, 92, "Input"],
Cell[20354, 488, 4300, 104, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24691, 597, 416, 9, 52, "Input"],
Cell[25110, 608, 676, 9, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25835, 623, 231, 3, 33, "Subsubtitle"],
Cell[CellGroupData[{
Cell[26091, 630, 1927, 49, 92, "Input"],
Cell[28021, 681, 3806, 96, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31864, 782, 1029, 23, 72, "Input"],
Cell[32896, 807, 568, 8, 31, "Output"],
Cell[33467, 817, 568, 8, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34084, 831, 237, 3, 33, "Subsubtitle"],
Cell[CellGroupData[{
Cell[34346, 838, 763, 16, 52, "Input"],
Cell[35112, 856, 1111, 27, 33, "Output"]
}, Open  ]],
Cell[36238, 886, 259, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[36522, 895, 1709, 40, 92, "Input"],
Cell[CellGroupData[{
Cell[38256, 939, 226, 4, 23, "Print"],
Cell[38485, 945, 223, 4, 23, "Print"],
Cell[38711, 951, 226, 4, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[38964, 959, 401, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[39390, 970, 1474, 37, 92, "Input"],
Cell[CellGroupData[{
Cell[40889, 1011, 174, 3, 23, "Print"],
Cell[41066, 1016, 174, 3, 23, "Print"],
Cell[41243, 1021, 177, 4, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41481, 1032, 205, 5, 57, "Subsubtitle"],
Cell[CellGroupData[{
Cell[41711, 1041, 1608, 45, 92, "Input"],
Cell[43322, 1088, 3901, 111, 95, "Output"]
}, Open  ]],
Cell[47238, 1202, 96, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[47359, 1207, 1588, 38, 92, "Input"],
Cell[CellGroupData[{
Cell[48972, 1249, 248, 4, 23, "Print"],
Cell[49223, 1255, 248, 4, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49520, 1265, 1156, 27, 72, "Input"],
Cell[CellGroupData[{
Cell[50701, 1296, 249, 5, 23, "Print"],
Cell[50953, 1303, 234, 5, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[51214, 1312, 650, 11, 87, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51901, 1328, 160, 5, 57, "Subsubtitle"],
Cell[CellGroupData[{
Cell[52086, 1337, 1177, 27, 72, "Input"],
Cell[53266, 1366, 6578, 181, 168, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59893, 1553, 194, 6, 57, "Subsubtitle"],
Cell[CellGroupData[{
Cell[60112, 1563, 951, 25, 52, "Input"],
Cell[61066, 1590, 3795, 110, 95, "Output"],
Cell[64864, 1702, 5935, 167, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70836, 1874, 873, 20, 72, "Input"],
Cell[71712, 1896, 99, 1, 31, "Output"],
Cell[71814, 1899, 97, 1, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71960, 1906, 301, 6, 57, "Subsubtitle"],
Cell[CellGroupData[{
Cell[72286, 1916, 1521, 34, 92, "Input"],
Cell[73810, 1952, 363, 5, 31, "Output"],
Cell[74176, 1959, 414, 7, 31, "Output"],
Cell[74593, 1968, 413, 7, 31, "Output"]
}, Open  ]],
Cell[75021, 1978, 205, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[75251, 1986, 1209, 30, 72, "Input"],
Cell[CellGroupData[{
Cell[76485, 2020, 199, 4, 23, "Print"],
Cell[76687, 2026, 199, 4, 23, "Print"],
Cell[76889, 2032, 205, 5, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[77121, 2041, 229, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[77375, 2050, 1306, 31, 72, "Input"],
Cell[CellGroupData[{
Cell[78706, 2085, 349, 6, 23, "Print"],
Cell[79058, 2093, 348, 6, 23, "Print"],
Cell[79409, 2101, 347, 6, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[79783, 2111, 108, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[79916, 2116, 2114, 53, 112, "Input"],
Cell[82033, 2171, 213, 4, 31, "Output"],
Cell[82249, 2177, 325, 7, 31, "Output"],
Cell[82577, 2186, 318, 7, 31, "Output"]
}, Open  ]],
Cell[82910, 2196, 422, 7, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83369, 2208, 148, 5, 57, "Subsubtitle"],
Cell[83520, 2215, 4681, 105, 312, "Input"],
Cell[CellGroupData[{
Cell[88226, 2324, 1034, 20, 112, "Input"],
Cell[89263, 2346, 1289, 34, 31, "Output"],
Cell[90555, 2382, 966, 22, 31, "Output"],
Cell[91524, 2406, 954, 22, 31, "Output"],
Cell[92481, 2430, 952, 22, 31, "Output"],
Cell[93436, 2454, 968, 22, 31, "Output"]
}, Open  ]],
Cell[94419, 2479, 565, 10, 49, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95021, 2494, 174, 5, 57, "Subsubtitle"],
Cell[95198, 2501, 1239, 31, 212, "Input"],
Cell[96440, 2534, 3071, 70, 192, "Input"],
Cell[CellGroupData[{
Cell[99536, 2608, 226, 3, 92, "Input"],
Cell[99765, 2613, 245, 4, 31, "Output"],
Cell[100013, 2619, 349, 7, 31, "Output"],
Cell[100365, 2628, 345, 7, 31, "Output"],
Cell[100713, 2637, 336, 6, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
