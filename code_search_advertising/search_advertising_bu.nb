(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     85074,       2293]
NotebookOptionsPosition[     80361,       2131]
NotebookOutlinePosition[     80705,       2146]
CellTagsIndexPosition[     80662,       2143]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Search Advertising: Numerical analysis", "Title",
 CellChangeTimes->{{3.5989415182915487`*^9, 3.598941530227742*^9}}],

Cell["Model: demand function, consumer type, and profit", "Subsubtitle",
 CellChangeTimes->{{3.598941534916211*^9, 3.598941567204439*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Demand", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", " ", "pbar_", ",", " ", "eta_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"p", " ", ">", " ", "pbar"}]}], "}"}], "}"}], ",", 
    RowBox[{"theta", " ", "+", " ", 
     RowBox[{"p", "^", 
      RowBox[{"(", 
       RowBox[{"-", "eta"}], ")"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InverseDemand", "[", 
   RowBox[{"theta_", ",", " ", "q_", ",", " ", "eta_"}], "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"theta", " ", ">", "q"}]}], "}"}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q", "-", "theta"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "eta"}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CdfTheta", "[", 
   RowBox[{"theta_", ",", " ", "gamma_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"theta", " ", "<", "0"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", 
        RowBox[{"theta", " ", ">", " ", "1"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"theta", "^", "gamma"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PdfTheta", "[", 
    RowBox[{"theta_", ",", " ", "gamma_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"CdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", "theta"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Profit", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", " ", "pbar_", ",", " ", "eta_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"p", ">", "pbar"}]}], " ", "}"}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "0.1"}], ")"}], "*", 
     RowBox[{"Demand", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivativeProfit", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", "pbar_", ",", " ", "eta_"}], "]"}], 
  "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Profit", "[", 
     RowBox[{"theta", ",", "p", ",", "pbar", ",", "eta"}], "]"}], ",", "p"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.598937564340193*^9, 3.598937565254284*^9}, {
  3.5989376158323417`*^9, 3.5989376383935976`*^9}, {3.598937716681425*^9, 
  3.5989378639381495`*^9}, {3.598937900915847*^9, 3.5989379040521603`*^9}, {
  3.598937985462301*^9, 3.5989379871104655`*^9}, {3.5989381460443573`*^9, 
  3.598938314211172*^9}, {3.5989384547462244`*^9, 3.598938476491399*^9}, {
  3.5989415781855373`*^9, 3.598941581351854*^9}, {3.5989428182945356`*^9, 
  3.59894287984669*^9}, {3.5998935082959642`*^9, 3.5998935086639643`*^9}, {
  3.6010530831063805`*^9, 3.601053087962623*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {"0", 
     RowBox[{"theta", "<", "0"}]},
    {
     RowBox[{"gamma", " ", 
      SuperscriptBox["theta", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "gamma"}]]}], 
     RowBox[{"0", "<", "theta", "<", "1"}]},
    {"0", 
     RowBox[{"theta", ">", "1"}]},
    {"Indeterminate", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.5989428417128773`*^9, 3.5989428812008257`*^9}, 
   3.5995379730602446`*^9, 3.5998821665142117`*^9, 3.5998870043819647`*^9, 
   3.5998935122309647`*^9, 3.6010530902051*^9, 3.6010931219606194`*^9}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {"0", 
     RowBox[{
      RowBox[{"p", "-", "pbar"}], ">", "0"}]},
    {
     RowBox[{
      FractionBox[
       RowBox[{"eta", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.1`"}], "+", "p"}], ")"}], " ", "theta"}], "p"], "-", 
      RowBox[{"eta", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "0.1`"}], "+", "p"}], ")"}], " ", 
       SuperscriptBox["p", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "eta"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[InvisibleSpace]", "+", 
         RowBox[{
          SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["p", 
        RowBox[{"-", "eta"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[InvisibleSpace]", "+", 
         RowBox[{
          SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}]}], 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.5989428417128773`*^9, 3.5989428812008257`*^9}, 
   3.5995379730602446`*^9, 3.5998821665142117`*^9, 3.5998870043819647`*^9, 
   3.5998935122309647`*^9, 3.6010530902051*^9, 3.6010931219796305`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Demand", "[", 
  RowBox[{"1", ",", " ", 
   RowBox[{"1", "/", "5"}], ",", " ", "1", ",", " ", "2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"InverseDemand", "[", 
  RowBox[{"1", ",", " ", "26", ",", " ", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Profit", "[", 
  RowBox[{"1", ",", 
   RowBox[{"1", "/", "5"}], ",", "1", ",", "2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CdfTheta", "[", 
  RowBox[{"0.5", ",", "0.5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5989379912248774`*^9, 3.598938018343589*^9}, {
  3.5989381201867723`*^9, 3.5989381320269556`*^9}, {3.598938318577609*^9, 
  3.598938326146366*^9}, {3.5989415867273912`*^9, 3.5989415885345716`*^9}}],

Cell[BoxData["26"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.601093125355899*^9}],

Cell[BoxData[
 FractionBox["1", "5"]], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.6010931253599014`*^9}],

Cell[BoxData["2.6`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.601093125361885*^9}],

Cell[BoxData["0.7071067811865476`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}, 3.599537975357239*^9, 3.599882170072605*^9, 
   3.5998870058989644`*^9, 3.5998935140249643`*^9, 3.601053097083713*^9, 
   3.6010931253628855`*^9}]
}, Open  ]],

Cell["\<\
Some issue (?): When eta increases, demand sensitivity increases => argmax of \
profit decreases... but max of profit increases (argmax closer to 0 in which \
demand goes to infinity)\
\>", "Text",
 CellChangeTimes->{{3.6010931636504107`*^9, 3.601093229385256*^9}, {
  3.6010944058970394`*^9, 3.601094467472089*^9}, {3.601094559327326*^9, 
  3.60109456911085*^9}, {3.6010947214702053`*^9, 3.6010947235505915`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Demand", "[", 
           RowBox[{"0.3", ",", " ", "p", ",", " ", "1.0", ",", "eta"}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"eta", ",", " ", "2", ",", "5"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "                            ", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Profit", "[", 
           RowBox[{"0.3", ",", " ", "p", ",", " ", "1.0", ",", "eta"}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"eta", ",", " ", "2", ",", "5"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "                            ", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"CdfTheta", "[", 
           RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"theta", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"gamma", ",", "0.5", ",", "1.5"}], "}"}]}], "]"}]}], "}"}], 
    "}"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5998949806439643`*^9, 3.599895118106964*^9}, 
   3.5998951843109646`*^9, {3.599895216052964*^9, 3.599895360778964*^9}, {
   3.599895413927964*^9, 3.5998954208879642`*^9}, {3.601093232636401*^9, 
   3.601093269307849*^9}, {3.6010933990747814`*^9, 3.6010933993949795`*^9}, {
   3.6010937186158075`*^9, 3.6010939125203543`*^9}, {3.6010939794329815`*^9, 
   3.6010939826551113`*^9}, {3.601094019310548*^9, 3.601094087366919*^9}, {
   3.6010942521745605`*^9, 3.6010942601258583`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     TagBox[
      FormBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`eta$$ = 2., Typeset`show$$ = True, 
         Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
         Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
         "\"untitled\"", Typeset`specs$$ = {{
           Hold[$CellContext`eta$$], 2, 5}}, Typeset`size$$ = {
         253., {81., 85.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`eta$8844$$ = 0}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          1, TraditionalForm, "Variables" :> {$CellContext`eta$$ = 2}, 
           "ControllerVariables" :> {
             Hold[$CellContext`eta$$, $CellContext`eta$8844$$, 0]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Plot[
             $CellContext`Demand[
             0.3, $CellContext`p, 1., $CellContext`eta$$], {$CellContext`p, 0,
               1}], "Specifications" :> {{$CellContext`eta$$, 2, 5}}, 
           "Options" :> {}, "DefaultOptions" :> {}],
          ImageSizeCache->{302., {125., 130.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       TraditionalForm],
      Manipulate`InterpretManipulate[1]], {193.5, -189.}, {
     Center, Center}, {360., 360.}], InsetBox[
     TagBox[
      FormBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`eta$$ = 2., Typeset`show$$ = True, 
         Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
         Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
         "\"untitled\"", Typeset`specs$$ = {{
           Hold[$CellContext`eta$$], 2, 5}}, Typeset`size$$ = {
         253., {73., 77.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`eta$8861$$ = 0}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          1, TraditionalForm, "Variables" :> {$CellContext`eta$$ = 2}, 
           "ControllerVariables" :> {
             Hold[$CellContext`eta$$, $CellContext`eta$8861$$, 0]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Plot[
             $CellContext`Profit[
             0.3, $CellContext`p, 1., $CellContext`eta$$], {$CellContext`p, 0,
               1}], "Specifications" :> {{$CellContext`eta$$, 2, 5}}, 
           "Options" :> {}, "DefaultOptions" :> {}],
          ImageSizeCache->{302., {117., 122.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       TraditionalForm],
      Manipulate`InterpretManipulate[1]], {580.5, -189.}, {
     Center, Center}, {360., 360.}], InsetBox[
     TagBox[
      FormBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`gamma$$ = 0.5, Typeset`show$$ = True, 
         Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
         Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
         "\"untitled\"", Typeset`specs$$ = {{
           Hold[$CellContext`gamma$$], 0.5, 1.5}}, Typeset`size$$ = {
         253., {80., 84.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`gamma$8878$$ = 0}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          1, TraditionalForm, "Variables" :> {$CellContext`gamma$$ = 0.5}, 
           "ControllerVariables" :> {
             Hold[$CellContext`gamma$$, $CellContext`gamma$8878$$, 0]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Plot[
             $CellContext`CdfTheta[$CellContext`theta, $CellContext`gamma$$], \
{$CellContext`theta, 0, 1}], 
           "Specifications" :> {{$CellContext`gamma$$, 0.5, 1.5}}, 
           "Options" :> {}, "DefaultOptions" :> {}],
          ImageSizeCache->{302., {124., 129.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       TraditionalForm],
      Manipulate`InterpretManipulate[1]], {967.5, -189.}, {
     Center, Center}, {360., 360.}]}, {}},
  ContentSelectable->True,
  ImageSize->{972., Automatic},
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{{3.601094090241849*^9, 3.6010941145990734`*^9}, {
  3.6010942566005073`*^9, 3.6010942618990636`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["First order condition (Privacy)", "Subsubtitle",
 CellChangeTimes->{{3.598943838678564*^9, 3.598943849462642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FirstOrderCondition", "[", 
   RowBox[{"p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_"}], 
   "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeProfit", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}], "*", 
     RowBox[{"PdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}]}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"FirstOrderCondition", "[", 
   RowBox[{"p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma"}], "]"}],
   "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5989392435710993`*^9, 3.598939358184559*^9}, {
   3.598939431356876*^9, 3.5989395598257217`*^9}, 3.5989396221489534`*^9, {
   3.598939661140852*^9, 3.598939665092247*^9}, {3.598940427377468*^9, 
   3.598940462114941*^9}, {3.5989417311658335`*^9, 3.59894178033575*^9}, {
   3.598942878214527*^9, 3.5989429688575907`*^9}, {3.601094758049591*^9, 
   3.601094760273074*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {
     RowBox[{"\[Piecewise]", GridBox[{
        {
         FractionBox[
          RowBox[{"0.1`", " ", 
           SuperscriptBox["p", 
            RowBox[{
             RowBox[{"-", "1.`"}], "-", 
             RowBox[{"1.`", " ", "eta"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{"eta", "+", 
             RowBox[{"eta", " ", "gamma"}], "+", 
             RowBox[{"10.`", " ", "p"}], "-", 
             RowBox[{"10.`", " ", "eta", " ", "p"}], "+", 
             RowBox[{"10.`", " ", "gamma", " ", "p"}], "-", 
             RowBox[{"10.`", " ", "eta", " ", "gamma", " ", "p"}], "+", 
             RowBox[{"10.`", " ", "gamma", " ", 
              SuperscriptBox["p", 
               RowBox[{"1.`", "\[InvisibleSpace]", "+", "eta"}]]}]}], ")"}]}], 
          RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma"}]], 
         RowBox[{
          RowBox[{"Re", "[", "gamma", "]"}], ">", "0.`"}]},
        {
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"0.1`", " ", "gamma", " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1.`"}], "-", 
              RowBox[{"1.`", " ", "eta"}]}]], " ", 
            SuperscriptBox["theta", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "gamma"}]], " ", 
            RowBox[{"(", 
             RowBox[{"eta", "+", 
              RowBox[{"10.`", " ", "p"}], "-", 
              RowBox[{"10.`", " ", "eta", " ", "p"}], "+", 
              RowBox[{"10.`", " ", 
               SuperscriptBox["p", 
                RowBox[{"1.`", "\[InvisibleSpace]", "+", "eta"}]], " ", 
               "theta"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"theta", ",", "0.`", ",", "1.`"}], "}"}], ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "-", 
               RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}], "&&", 
             RowBox[{
              RowBox[{"Re", "[", "gamma", "]"}], "\[LessEqual]", 
              "0.`"}]}]}]}], "]"}], 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->False,
          DeletionWarning->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}], 
     RowBox[{
      RowBox[{"p", "-", 
       RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}]},
    {"0.`", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.598939481074847*^9, 3.598939486616401*^9}, {
   3.598939518746614*^9, 3.5989395613598747`*^9}, 3.598939625590297*^9, 
   3.5989396669874363`*^9, {3.598940430139744*^9, 3.5989404425229826`*^9}, 
   3.598940763352062*^9, 3.598941605405259*^9, {3.598941737456463*^9, 
   3.59894178123884*^9}, {3.598942935833288*^9, 3.5989429710398088`*^9}, 
   3.599537977872984*^9, 3.599882177048234*^9, 3.5998870121319647`*^9, 
   3.5998935271109643`*^9, 3.6010531350059695`*^9, 3.6010946498426695`*^9, {
   3.6010947709292536`*^9, 3.6010947933221817`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FirstOrderCondition", "[", 
  RowBox[{"0.202779", ",", " ", "1.0", ",", " ", "2.0", ",", " ", "0.5"}], 
  "]"}]], "Input"],

Cell[BoxData["0.00004538050585388973`"], "Output",
 CellChangeTimes->{{3.598939481074847*^9, 3.598939486616401*^9}, {
   3.598939518746614*^9, 3.5989395613598747`*^9}, 3.598939625590297*^9, 
   3.5989396669874363`*^9, {3.598940430139744*^9, 3.5989404425229826`*^9}, 
   3.598940763352062*^9, 3.598941605405259*^9, {3.598941737456463*^9, 
   3.59894178123884*^9}, {3.598942935833288*^9, 3.5989429710398088`*^9}, 
   3.599537977872984*^9, 3.599882177048234*^9, 3.5998870121319647`*^9, 
   3.5998935271109643`*^9, 3.6010531350059695`*^9, 3.60109464991872*^9, 
   3.601094772561341*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results: Profit, CS, Welfare", "Subsubtitle",
 CellChangeTimes->{{3.598941419983719*^9, 3.5989414228960094`*^9}, {
  3.598941474082128*^9, 3.5989414854902687`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpectedTheta", "[", "gamma_", "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"theta", "*", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"CdfTheta", "[", 
        RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", " ", "theta"}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedProfit", "[", 
   RowBox[{"p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_"}], 
   "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Profit", "[", 
      RowBox[{"theta", ",", "p", ",", "pbar", ",", "eta"}], "]"}], "*", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"CdfTheta", "[", 
        RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", " ", "theta"}], 
      "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedConsumerSurplus", "[", 
   RowBox[{"theta_", ",", " ", "qstar_", ",", " ", "eta_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"InverseDemand", "[", 
     RowBox[{"theta", ",", " ", "q", ",", " ", "eta"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"q", ",", " ", "0", ",", " ", "qstar"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"ExpectedProfit", "[", 
   RowBox[{"p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma"}], "]"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.5989405052002497`*^9, 3.598940701976925*^9}, {
  3.59894079833356*^9, 3.5989409393626614`*^9}, {3.598941023830107*^9, 
  3.59894102426315*^9}, {3.5989410862973533`*^9, 3.598941087288452*^9}, {
  3.5989418268023963`*^9, 3.598941846354351*^9}, {3.601094687226592*^9, 
  3.601094688777626*^9}, {3.601094776932273*^9, 3.6010947875063076`*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {
     RowBox[{"\[Piecewise]", GridBox[{
        {
         FractionBox[
          RowBox[{"0.1`", " ", 
           SuperscriptBox["p", 
            RowBox[{
             RowBox[{"-", "1.`"}], " ", "eta"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1.`"}], "+", 
             RowBox[{"10.`", " ", "p"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma", "+", 
             RowBox[{"gamma", " ", 
              SuperscriptBox["p", "eta"]}]}], ")"}]}], 
          RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma"}]], 
         RowBox[{
          RowBox[{"Re", "[", "gamma", "]"}], ">", "0.`"}]},
        {
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"0.1`", " ", "gamma", " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1.`"}], " ", "eta"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", 
              RowBox[{"10.`", " ", "p"}]}], ")"}], " ", 
            SuperscriptBox["theta", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "gamma"}]], " ", 
            RowBox[{"(", 
             RowBox[{"1.`", "\[InvisibleSpace]", "+", 
              RowBox[{
               SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"theta", ",", "0.`", ",", "1.`"}], "}"}], ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "-", 
               RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}], "&&", 
             RowBox[{
              RowBox[{"Re", "[", "gamma", "]"}], "\[LessEqual]", 
              "0.`"}]}]}]}], "]"}], 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->False,
          DeletionWarning->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}], 
     RowBox[{
      RowBox[{"p", "-", 
       RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}]},
    {"0.`", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9, 3.5995379807950053`*^9, 3.599882178931491*^9, 
   3.5998870139049644`*^9, 3.5998935288549643`*^9, 3.601053151339857*^9, 
   3.6010946566482077`*^9, 3.6010946968049774`*^9, 3.6010947885660233`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ExpectedTheta", "[", "0.5", "]"}], "\[IndentingNewLine]", 
   RowBox[{"ExpectedProfit", "[", 
    RowBox[{"0.2", ",", " ", "1.0", ",", " ", "2.0", ",", " ", "0.5"}], "]"}],
    "\[IndentingNewLine]", 
   RowBox[{"ExpectedConsumerSurplus", "[", 
    RowBox[{
     RowBox[{"ExpectedTheta", "[", "0.5", "]"}], ",", "26", ",", " ", "2.0"}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6010947816734343`*^9, 3.6010947859042377`*^9}}],

Cell[BoxData[
 FractionBox["1", "3"]], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9, 3.5995379807950053`*^9, 3.599882178931491*^9, 
   3.5998870139049644`*^9, 3.5998935288549643`*^9, 3.601053151339857*^9, 
   3.6010946566802273`*^9, 3.6010947909125757`*^9}],

Cell[BoxData["2.5333333333333328`"], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9, 3.5995379807950053`*^9, 3.599882178931491*^9, 
   3.5998870139049644`*^9, 3.5998935288549643`*^9, 3.601053151339857*^9, 
   3.6010946566802273`*^9, 3.601094790961608*^9}],

Cell[BoxData["10.132456102380443`"], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9, 3.5995379807950053`*^9, 3.599882178931491*^9, 
   3.5998870139049644`*^9, 3.5998935288549643`*^9, 3.601053151339857*^9, 
   3.6010946566802273`*^9, 3.601094791017645*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computation of equilibria: Tests (no need to redo)\
\>", "Subsubtitle",
 CellChangeTimes->{{3.598942016165331*^9, 3.5989420462623405`*^9}, {
  3.5998934651719646`*^9, 3.5998934736349645`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"NSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FirstOrderCondition", "[", 
      RowBox[{"p", ",", " ", "1.0", ",", " ", "2.0", ",", " ", "0.5"}], "]"}],
      " ", "\[Equal]", " ", "0"}], ",", " ", "p"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5989418839861145`*^9, 3.5989419391716323`*^9}, {
   3.5989489923838825`*^9, 3.5989490205937033`*^9}, 3.599882733765378*^9, {
   3.6010930949996614`*^9, 3.6010931181881166`*^9}, {3.6010958750618205`*^9, 
   3.6010958786131873`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"1.`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.`", " ", 
       RowBox[{
        TagBox[
         SuperscriptBox["UnitStep", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]],
         {InverseFunction, 1, 1},
         Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"-", "1.8245148778558737`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.2027793946151302`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "1.6217354832407433`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5989490132279673`*^9, 3.5989626276184206`*^9, 3.5998821866956654`*^9, 
   3.599882739281068*^9, 3.599887022073964*^9, 3.5998935329519644`*^9, 
   3.599894454455964*^9, 3.6010531588058343`*^9, {3.6010930991323986`*^9, 
   3.6010931123142085`*^9}, 3.601094803994296*^9, 3.6010951778315334`*^9, 
   3.601095888050479*^9}]
}, Open  ]],

Cell["\<\
Solving for various gamma (higher gamma: higher density of consumers towards \
gamma value 1 and thus higher profit)\
\>", "Text",
 CellChangeTimes->{{3.599538430299038*^9, 3.599538529280962*^9}, {
  3.6010953305447917`*^9, 3.6010953353850183`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0.5"}], ",", 
    RowBox[{"i", "\[LessEqual]", "1.5"}], ",", 
    RowBox[{"i", "+=", "0.5"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"i", " ", ",", " ", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FirstOrderCondition", "[", 
          RowBox[{"p", " ", ",", " ", "1.0", ",", " ", "2.0", ",", " ", "i"}],
           "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", "p"}], "]"}]}], 
     "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.601094852456605*^9, 3.6010948690076523`*^9}, {
  3.601094899351886*^9, 3.6010949776470833`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"0.5`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"1.`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.`", " ", 
         RowBox[{
          TagBox[
           SuperscriptBox["UnitStep", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]],
           {InverseFunction, 1, 1},
           Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"-", "1.8245148778558737`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "0.2027793946151302`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "1.6217354832407433`"}], "}"}]}], "}"}]}],
  SequenceForm[
  0.5, {{$CellContext`p -> 
     1. - 1. InverseFunction[UnitStep, 1, 1][
       0.]}, {$CellContext`p -> -1.8245148778558737`}, {$CellContext`p -> 
     0.2027793946151302}, {$CellContext`p -> 1.6217354832407433`}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.601094872404905*^9, {3.601094961823516*^9, 3.6010949790660105`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1.`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"1.`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.`", " ", 
         RowBox[{
          TagBox[
           SuperscriptBox["UnitStep", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]],
           {InverseFunction, 1, 1},
           Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"-", "1.5052371435433938`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "0.20426115523299948`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "1.300975988310394`"}], "}"}]}], "}"}]}],
  SequenceForm[
  1., {{$CellContext`p -> 
     1. - 1. InverseFunction[UnitStep, 1, 1][
       0.]}, {$CellContext`p -> -1.5052371435433938`}, {$CellContext`p -> 
     0.20426115523299948`}, {$CellContext`p -> 1.300975988310394}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.601094872404905*^9, {3.601094961823516*^9, 3.601094979113043*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1.5`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"1.`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.`", " ", 
         RowBox[{
          TagBox[
           SuperscriptBox["UnitStep", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]],
           {InverseFunction, 1, 1},
           Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"-", "1.3812984820439949`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "0.20518292468904759`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "1.176115557354947`"}], "}"}]}], "}"}]}],
  SequenceForm[
  1.5, {{$CellContext`p -> 
     1. - 1. InverseFunction[UnitStep, 1, 1][
       0.]}, {$CellContext`p -> -1.3812984820439949`}, {$CellContext`p -> 
     0.20518292468904759`}, {$CellContext`p -> 1.176115557354947}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.601094872404905*^9, {3.601094961823516*^9, 3.6010949792201138`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ExpectedProfit", "[", 
     RowBox[{"0.202779", ",", " ", "1.0", ",", "2.0", ",", "0.5"}], "]"}], 
    ",", " ", 
    RowBox[{"ExpectedProfit", "[", 
     RowBox[{"0.204261", ",", " ", "1.0", ",", "2.0", ",", "1"}], "]"}], ",", 
    RowBox[{"ExpectedProfit", "[", 
     RowBox[{"0.205183", ",", " ", "1.0", ",", "2.0", ",", "1.5"}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.601095268300295*^9, 3.6010953052038975`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.533790128231545`", ",", "2.551042592002025`", ",", 
   "2.5615145833439126`"}], "}"}]], "Print",
 CellChangeTimes->{3.6010953072992764`*^9}]
}, Open  ]],

Cell["\<\
Solving for various eta (higher eta: higher demand sensitivity... but profit \
increases while price decreases due to higher sensitivity)\
\>", "Text",
 CellChangeTimes->{{3.599538552313297*^9, 3.5995385717212114`*^9}, {
  3.6010949969719663`*^9, 3.601095059650756*^9}, {3.601095155066347*^9, 
  3.601095156250147*^9}, {3.6010953206251783`*^9, 3.6010953263690033`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "2.0"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3.0"}], ",", 
    RowBox[{"i", "+=", "0.5"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"i", " ", ",", " ", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FirstOrderCondition", "[", 
          RowBox[{"p", " ", ",", " ", "1.0", ",", " ", "i", ",", " ", "1"}], 
          "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", "p"}], "]"}]}], 
     "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.599538573755581*^9, 3.599538597826644*^9}, 
   3.5998827368934636`*^9, 3.6010949906307383`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"2.`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"1.`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.`", " ", 
         RowBox[{
          TagBox[
           SuperscriptBox["UnitStep", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]],
           {InverseFunction, 1, 1},
           Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"-", "1.5052371435433938`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "0.20426115523299948`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "1.300975988310394`"}], "}"}]}], "}"}]}],
  SequenceForm[
  2., {{$CellContext`p -> 
     1. - 1. InverseFunction[UnitStep, 1, 1][
       0.]}, {$CellContext`p -> -1.5052371435433938`}, {$CellContext`p -> 
     0.20426115523299948`}, {$CellContext`p -> 1.300975988310394}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.599538601188883*^9, 3.5995386721391354`*^9, 
  3.599882745152971*^9, 3.5998870257739644`*^9, 3.5998935549129643`*^9, 
  3.6010949931073723`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"2.5`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"1.`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.`", " ", 
         RowBox[{
          TagBox[
           SuperscriptBox["UnitStep", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]],
           {InverseFunction, 1, 1},
           Editable->False], "[", "0", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "1.318300833086658`"}], "-", 
        RowBox[{"0.9145701464482043`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "1.318300833086658`"}], "+", 
        RowBox[{"0.9145701464482043`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "0.1673051675292797`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "1.4793972978052445`"}], "}"}]}], "}"}]}],
  SequenceForm[
  2.5, {{$CellContext`p -> 
     1. - 1. InverseFunction[UnitStep, 1, 1][0]}, {$CellContext`p -> 
     Complex[-1.318300833086658, -0.9145701464482043]}, {$CellContext`p -> 
     Complex[-1.318300833086658, 0.9145701464482043]}, {$CellContext`p -> 
     0.1673051675292797}, {$CellContext`p -> 1.4793972978052445`}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.599538601188883*^9, 3.5995386721391354`*^9, 
  3.599882745152971*^9, 3.5998870257739644`*^9, 3.5998935549129643`*^9, 
  3.601094993163411*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"3.`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"1.`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.`", " ", 
         RowBox[{
          TagBox[
           SuperscriptBox["UnitStep", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]],
           {InverseFunction, 1, 1},
           Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "0.8419991506427064`"}], "-", 
        RowBox[{"1.3771754513377148`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "0.8419991506427064`"}], "+", 
        RowBox[{"1.3771754513377148`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "0.15012699164137902`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", "\[Rule]", "1.5338713096440348`"}], "}"}]}], "}"}]}],
  SequenceForm[
  3., {{$CellContext`p -> 
     1. - 1. InverseFunction[UnitStep, 1, 1][0.]}, {$CellContext`p -> 
     Complex[-0.8419991506427064, -1.3771754513377148`]}, {$CellContext`p -> 
     Complex[-0.8419991506427064, 1.3771754513377148`]}, {$CellContext`p -> 
     0.15012699164137902`}, {$CellContext`p -> 1.5338713096440348`}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.599538601188883*^9, 3.5995386721391354`*^9, 
  3.599882745152971*^9, 3.5998870257739644`*^9, 3.5998935549129643`*^9, 
  3.601094993214443*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ExpectedProfit", "[", 
     RowBox[{"0.204261", ",", " ", "1.0", ",", "2.0", ",", "1"}], "]"}], ",", 
    " ", 
    RowBox[{"ExpectedProfit", "[", 
     RowBox[{"0.167305", ",", " ", "1.0", ",", "2.5", ",", "1"}], "]"}], ",", 
    RowBox[{"ExpectedProfit", "[", 
     RowBox[{"0.150127", ",", " ", "1.0", ",", "3.0", ",", "1"}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6010950757244635`*^9, 3.6010951469329357`*^9}, {
  3.6010952139010286`*^9, 3.6010952384614024`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.551042592002025`", ",", "5.912267627430385`", ",", 
   "14.83984652687993`"}], "}"}]], "Print",
 CellChangeTimes->{3.6010952395811415`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Order statistics\
\>", "Subsubtitle",
 CellChangeTimes->{{3.598943000248729*^9, 3.598943003640068*^9}, 
   3.6010959351889043`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PdfOrderStat", "[", 
     RowBox[{"x_", ",", "k_", ",", "n_", ",", " ", "gamma_"}], "]"}], ":=", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "!"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], "!"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "k"}], ")"}], "!"}]}], ")"}]}], "*", 
     RowBox[{
      RowBox[{"CdfTheta", "[", 
       RowBox[{"x", ",", " ", "gamma"}], "]"}], "^", 
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"CdfTheta", "[", 
         RowBox[{"x", ",", " ", "gamma"}], "]"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "k"}], ")"}]}], "*", 
     RowBox[{"PdfTheta", "[", 
      RowBox[{"x", ",", " ", "gamma"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CdfOrderStat", "[", 
     RowBox[{"y_", ",", "k_", ",", "n_", ",", "gamma_"}], "]"}], " ", "=", 
    " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"PdfOrderStat", "[", 
       RowBox[{"x", ",", "k", ",", "n", ",", "gamma"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "y"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5989430116388683`*^9, 3.598943068715575*^9}, {
  3.5989431007967834`*^9, 3.598943237650467*^9}, {3.598943270003702*^9, 
  3.598943303605062*^9}, {3.598943570719771*^9, 3.598943633208019*^9}}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "y"], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"n", "!"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{"x", "<", "0"}]},
           {"1", 
            RowBox[{"x", ">", "1"}]},
           {
            SuperscriptBox["x", "gamma"], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->False,
             DeletionWarning->True]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}]}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "k"}], "+", "n"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Piecewise]", GridBox[{
          {"0", 
           RowBox[{"x", "<", "0"}]},
          {"1", 
           RowBox[{"x", ">", "1"}]},
          {
           SuperscriptBox["x", "gamma"], 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->False,
            DeletionWarning->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}]], " ", 
     RowBox[{"(", 
      RowBox[{"\[Piecewise]", GridBox[{
         {"0", 
          RowBox[{"x", "<", "0"}]},
         {
          RowBox[{"gamma", " ", 
           SuperscriptBox["x", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "gamma"}]]}], 
          RowBox[{"0", "<", "x", "<", "1"}]},
         {"0", 
          RowBox[{"x", ">", "1"}]},
         {"Indeterminate", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->False,
           DeletionWarning->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "k"}], ")"}], "!"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "k"}], "+", "n"}], ")"}], "!"}]}]], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Output",
 CellChangeTimes->{3.5989436348761854`*^9, 3.59988229501688*^9, 
  3.5998870280209646`*^9, 3.599893590337964*^9, 3.601095449429541*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"PdfOrderStat", "[", 
       RowBox[{"x", ",", "3", ",", "4", ",", "0.5"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.5"}], "}"}]}], "]"}], ",", 
    RowBox[{"CdfOrderStat", "[", 
     RowBox[{"0.5", ",", "3", ",", "4", ",", "0.5"}], "]"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"PdfOrderStat", "[", 
       RowBox[{"x", ",", "2", ",", "4", ",", "0.5"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.5"}], "}"}]}], "]"}], ",", 
    RowBox[{"CdfOrderStat", "[", 
     RowBox[{"0.5", ",", "2", ",", "4", ",", "0.5"}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5989431662183247`*^9, 3.598943182510954*^9}, {
  3.5989432413458366`*^9, 3.5989432535860605`*^9}, {3.598943326037305*^9, 
  3.5989433275244536`*^9}, {3.598943700210718*^9, 3.5989437796376605`*^9}, {
  3.598950105912225*^9, 3.5989501061672497`*^9}, {3.6010954125319233`*^9, 
  3.6010954366530194`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6642135623730951`", ",", "0.6642135623730951`"}], "}"}]], "Print",
 CellChangeTimes->{{3.6010954372403927`*^9, 3.601095451712041*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9215728752538097`", ",", "0.9215728752538097`"}], "}"}]], "Print",
 CellChangeTimes->{{3.6010954372403927`*^9, 3.601095451799099*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CdfTheta", "[", 
  RowBox[{"0.4", ",", "0.5"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CdfOrderStat", "[", 
  RowBox[{"0.4", ",", "2", ",", "2", ",", "0.5"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CdfOrderStat", "[", 
  RowBox[{"0.4", ",", "1", ",", "2", ",", "0.5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.598949731200757*^9, 3.5989498915677924`*^9}, {
  3.5989500993195653`*^9, 3.5989501014317765`*^9}, {3.5989501586174946`*^9, 
  3.598950202858918*^9}, {3.5989502683974714`*^9, 3.598950280541686*^9}, {
  3.5989503138230133`*^9, 3.598950316559287*^9}}],

Cell[BoxData["0.6324555320336759`"], "Output",
 CellChangeTimes->{{3.598949748748512*^9, 3.5989498930299387`*^9}, {
   3.598950167344367*^9, 3.5989502042100534`*^9}, {3.5989502719408255`*^9, 
   3.598950284261058*^9}, 3.5989503188385153`*^9, 3.599882295288061*^9, 
   3.599887032632964*^9, 3.6010954563861694`*^9}],

Cell[BoxData["0.4`"], "Output",
 CellChangeTimes->{{3.598949748748512*^9, 3.5989498930299387`*^9}, {
   3.598950167344367*^9, 3.5989502042100534`*^9}, {3.5989502719408255`*^9, 
   3.598950284261058*^9}, 3.5989503188385153`*^9, 3.599882295288061*^9, 
   3.599887032632964*^9, 3.60109545638916*^9}],

Cell[BoxData["0.8649110640673519`"], "Output",
 CellChangeTimes->{{3.598949748748512*^9, 3.5989498930299387`*^9}, {
   3.598950167344367*^9, 3.5989502042100534`*^9}, {3.5989502719408255`*^9, 
   3.598950284261058*^9}, 3.5989503188385153`*^9, 3.599882295288061*^9, 
   3.599887032632964*^9, 3.6010954565122423`*^9}]
}, Open  ]],

Cell["\<\
Reading (General: Proba that the kth highest draw among n is below y)
With gamma as 0.5 and only one draw, the probability to draw a theta lower \
than 0.4 is c. 0.63. 
With the same gamma and two draws: the proba that the highest of both (the \
2nd of 2) is below 0.4 is 0.4 (<0.63) and the proba that the lowest (the 1st \
of 2) is below 0.4 is c. 0.86.\
\>", "Text",
 CellChangeTimes->{{3.5989499164792833`*^9, 3.5989500844850817`*^9}, {
  3.5989501417998133`*^9, 3.598950150247658*^9}, {3.598950184585091*^9, 
  3.5989502628279147`*^9}, {3.598950300221654*^9, 3.5989503066212935`*^9}, {
  3.601095488496566*^9, 3.6010955296720185`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

First order condition (Disclosure)\
\>", "Subsubtitle",
 CellChangeTimes->{{3.598943824422138*^9, 3.5989438565343494`*^9}, 
   3.601095800821326*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FirstOrderConditionDisclosure", "[", 
   RowBox[{
   "p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_", ",", "k_", 
    ",", "n_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeProfit", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}], "*", 
     RowBox[{"PdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}], "*", " ", 
     RowBox[{"CdfOrderStat", "[", 
      RowBox[{"theta", ",", "k", ",", "n", ",", "gamma"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"FirstOrderConditionDisclosure", "[", 
   RowBox[{
   "p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma", ",", "k", ",", 
    "n"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.598943859176614*^9, 3.598943940956791*^9}, {
  3.598944023440038*^9, 3.598944026351329*^9}, {3.5989448769103765`*^9, 
  3.598944898254511*^9}, {3.5989512837309947`*^9, 3.5989512852991514`*^9}, {
  3.6010958258950415`*^9, 3.6010958395361357`*^9}}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "1"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "theta"], 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"n", "!"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Piecewise]", GridBox[{
              {"0", 
               RowBox[{"x", "<", "0"}]},
              {"1", 
               RowBox[{"x", ">", "1"}]},
              {
               SuperscriptBox["x", "gamma"], 
               TagBox["True",
                "PiecewiseDefault",
                AutoDelete->False,
                DeletionWarning->True]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{1.}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.84]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}]}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "k"}], "+", "n"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Piecewise]", GridBox[{
             {"0", 
              RowBox[{"x", "<", "0"}]},
             {"1", 
              RowBox[{"x", ">", "1"}]},
             {
              SuperscriptBox["x", "gamma"], 
              TagBox["True",
               "PiecewiseDefault",
               AutoDelete->False,
               DeletionWarning->True]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}]], " ", 
        RowBox[{"(", 
         RowBox[{"\[Piecewise]", GridBox[{
            {"Indeterminate", 
             RowBox[{
              RowBox[{"x", "\[Equal]", "0"}], "||", 
              RowBox[{"x", "\[Equal]", "1"}]}]},
            {
             RowBox[{"gamma", " ", 
              SuperscriptBox["x", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "gamma"}]]}], 
             RowBox[{"0", "<", "x", "<", "1"}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->False,
              DeletionWarning->True]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}]}], 
       RowBox[{
        RowBox[{"Gamma", "[", "k", "]"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"1", "-", "k", "+", "n"}], "]"}]}]], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{"p", ">", "pbar"}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["p", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "eta"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"eta", " ", 
             RowBox[{"(", 
              RowBox[{"0.1`", "\[InvisibleSpace]", "-", 
               RowBox[{"1.`", " ", "p"}]}], ")"}]}], "+", 
            RowBox[{"1.`", " ", "p"}]}], ")"}]}], "+", "theta"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->False,
         DeletionWarning->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"\[Piecewise]", GridBox[{
       {"Indeterminate", 
        RowBox[{
         RowBox[{"theta", "\[Equal]", "0"}], "||", 
         RowBox[{"theta", "\[Equal]", "1"}]}]},
       {
        RowBox[{"gamma", " ", 
         SuperscriptBox["theta", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "gamma"}]]}], 
        RowBox[{"0", "<", "theta", "<", "1"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->False,
         DeletionWarning->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}]}], ")"}], 
   RowBox[{"\[DifferentialD]", "theta"}]}]}]], "Output",
 CellChangeTimes->{3.6010958878073163`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Computation of equilibria (Disclosure) : Tests\[AliasDelimiter]\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5995383840032053`*^9, 3.5995383950345354`*^9}, {
   3.5998934939219646`*^9, 3.5998934956509647`*^9}, 3.6010958019891043`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FirstOrderConditionDisclosure", "[", 
  RowBox[{"0.21", ",", "1.0", ",", "2.0", ",", "0.5", ",", "4", ",", "9"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FirstOrderConditionDisclosure", "[", 
     RowBox[{
     "p", ",", " ", "1.0", ",", "2.0", ",", "0.5", ",", "4", ",", "9"}], 
     "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FirstOrderConditionDisclosure", "[", 
     RowBox[{
     "p", ",", " ", "1.0", ",", "2.0", ",", "0.5", ",", "9", ",", "9"}], 
     "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.598944806298316*^9, 3.5989448083615227`*^9}, {
   3.5989448393876247`*^9, 3.598944863019988*^9}, {3.598944906717357*^9, 
   3.598944939390624*^9}, 3.598948824857132*^9, {3.5998870416019645`*^9, 
   3.5998870551229644`*^9}, {3.6010955724765687`*^9, 3.601095577538925*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.34484789586831077`"}]], "Output",
 CellChangeTimes->{{3.5989448236860547`*^9, 3.5989449418918743`*^9}, 
   3.598948827650411*^9, 3.598951294276049*^9, 3.599882304395131*^9, 
   3.5998870563399644`*^9, 3.5998944031349645`*^9, 3.601095579281087*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p", "\[Rule]", "0.20430710246268755`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5989448236860547`*^9, 3.5989449418918743`*^9}, 
   3.598948827650411*^9, 3.598951294276049*^9, 3.599882304395131*^9, 
   3.5998870563399644`*^9, 3.5998944031349645`*^9, 3.6010955886603403`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p", "\[Rule]", "0.2074385283414616`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5989448236860547`*^9, 3.5989449418918743`*^9}, 
   3.598948827650411*^9, 3.598951294276049*^9, 3.599882304395131*^9, 
   3.5998870563399644`*^9, 3.5998944031349645`*^9, 3.6010955917493987`*^9}]
}, Open  ]],

Cell["\<\
Solving for various gamma (higher gamma: higher density of consumers towards \
gamma value 1 and thus higher profit)\
\>", "Text",
 CellChangeTimes->{3.601095699583291*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0.5"}], ",", 
    RowBox[{"i", "\[LessEqual]", "1.5"}], ",", 
    RowBox[{"i", "+=", "0.5"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"i", " ", ",", " ", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FirstOrderConditionDisclosure", "[", 
          RowBox[{
          "p", ",", " ", "1.0", ",", "2.0", ",", "i", ",", "5", ",", "9"}], 
          "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}], "]"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.598965158457479*^9, 3.598965169050538*^9}, {
  3.598965535224152*^9, 3.5989655427279024`*^9}, {3.5989656242370524`*^9, 
  3.598965624763105*^9}, {3.601095609882491*^9, 3.6010956342747526`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"0.5`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.20481675112284412`"}], "}"}]}],
  SequenceForm[0.5, {$CellContext`p -> 0.20481675112284412`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.5989651964202747`*^9, 3.598965572270856*^9, 
  3.599882387093265*^9, 3.599887119462964*^9, 3.601095664596964*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1.`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.20639425765545186`"}], "}"}]}],
  SequenceForm[1., {$CellContext`p -> 0.20639425765545186`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.5989651964202747`*^9, 3.598965572270856*^9, 
  3.599882387093265*^9, 3.599887119462964*^9, 3.60109566801024*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1.5`", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.20713405938092277`"}], "}"}]}],
  SequenceForm[1.5, {$CellContext`p -> 0.20713405938092277`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.5989651964202747`*^9, 3.598965572270856*^9, 
  3.599882387093265*^9, 3.599887119462964*^9, 3.601095677408506*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Solving for various eta (higher eta: higher demand sensitivity... but profit \
increases while price decreases due to higher sensitivity)\
\>", "Text",
 CellChangeTimes->{3.601095712534941*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "2.0"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3.0"}], ",", 
    RowBox[{"i", "+=", "0.5"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"{", 
      RowBox[{"i", " ", ",", " ", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstOrderConditionDisclosure", "[", 
           RowBox[{
           "p", ",", " ", "1.0", ",", "i", ",", "0.5", ",", "5", ",", "9"}], 
           "]"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"p", ",", "0.1"}], "}"}]}], "]"}]}], "}"}], "]"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.598965280414674*^9, 3.5989652962872605`*^9}, {
  3.5998912216859646`*^9, 3.5998912528189645`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.`", ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.20481675112284412`"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.598965321956827*^9, 3.5998825192833915`*^9, 
  3.599887232705964*^9, 3.5998912765139647`*^9, 3.6010957451802344`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.5`", ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.16738373898313202`"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.598965321956827*^9, 3.5998825192833915`*^9, 
  3.599887232705964*^9, 3.5998912765139647`*^9, 3.6010957761578865`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.`", ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.15014244319537223`"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.598965321956827*^9, 3.5998825192833915`*^9, 
  3.599887232705964*^9, 3.5998912765139647`*^9, 3.6010958016068506`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Output for privacy\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5998910360639644`*^9, 3.5998910419839644`*^9}, 
   3.6010957976532135`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"Apply", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0.5", ",", "1.5", ",", "0.5"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "2.0", ",", " ", "3.0", ",", " ", "0.5"}], 
         "}"}]}], "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arparam", " ", "=", " ", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arresult", "=", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arprofit", " ", "=", " ", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arcsurplus", " ", "=", " ", 
   RowBox[{"Range", "[", "dim", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Quiet", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"count", " ", "=", " ", 
       RowBox[{"count", " ", "+", " ", "1"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"arsol", " ", "=", " ", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstOrderCondition", "[", 
           RowBox[{"p", " ", ",", " ", "1.0", ",", " ", "j", ",", " ", "i"}], 
           "]"}], " ", "\[Equal]", " ", "0"}], " ", ",", " ", "p"}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"p", "/.", "arsol"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
           RowBox[{"#", "\[LessEqual]", " ", "1"}]}], "&"}]}], "]"}]}], " ", 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arresult", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", 
       RowBox[{"sol", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arparam", "[", 
        RowBox[{"[", "count", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arprofit", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", 
       RowBox[{"ExpectedProfit", "[", 
        RowBox[{
         RowBox[{"arresult", "[", 
          RowBox[{"[", "count", "]"}], "]"}], ",", " ", "1.0", ",", " ", "j", 
         ",", " ", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"etheta", "=", 
       RowBox[{"ExpectedTheta", "[", "i", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"eqstar", " ", "=", 
       RowBox[{"Demand", "[", 
        RowBox[{"etheta", ",", " ", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "1.0", ",", " ", "j"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arcsurplus", "[", 
        RowBox[{"[", "count", "]"}], "]"}], "=", 
       RowBox[{"ExpectedConsumerSurplus", "[", 
        RowBox[{"etheta", ",", " ", "eqstar", ",", " ", "j"}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0.5", ",", "1.5", ",", "0.5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", " ", "2.0", ",", " ", "3.0", ",", " ", "0.5"}], 
     "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5998833342823334`*^9, 3.5998833419754477`*^9}, {
   3.599883382935752*^9, 3.599883389186921*^9}, {3.5998835035431576`*^9, 
   3.599883591759968*^9}, {3.5998839221557374`*^9, 3.5998839581657443`*^9}, {
   3.5998840476984324`*^9, 3.5998841256123753`*^9}, {3.5998841896941*^9, 
   3.5998841938908973`*^9}, 3.5998893619529643`*^9, {3.5998893921579647`*^9, 
   3.5998894176289644`*^9}, {3.5998894893199644`*^9, 3.5998894913199644`*^9}, 
   3.5998895439569645`*^9, {3.5998896934669647`*^9, 3.5998897147629642`*^9}, {
   3.5998914064459643`*^9, 3.5998914347309647`*^9}, {3.5998925280829644`*^9, 
   3.5998926107999644`*^9}, {3.5998926423669643`*^9, 
   3.5998927117379646`*^9}, {3.599892776309964*^9, 3.5998928197149644`*^9}, {
   3.5998929085089645`*^9, 3.5998929378039646`*^9}, {3.5998929961999645`*^9, 
   3.5998930115119643`*^9}, {3.599893086401964*^9, 3.5998932178349648`*^9}, {
   3.601095983615189*^9, 3.60109598808617*^9}, {3.6010961315257964`*^9, 
   3.601096137165556*^9}, 3.6010966185525465`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Partition", "[", 
  RowBox[{"arparam", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arresult", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arprofit", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arcsurplus", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Partition", "[", 
  RowBox[{"arresult", ",", " ", 
   RowBox[{"Sqrt", "[", "dim", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5998834004474444`*^9, 3.5998834037346177`*^9}, {
  3.5998841326970987`*^9, 3.599884150288827*^9}, {3.599890039488964*^9, 
  3.5998900397449646`*^9}, {3.5998930256009645`*^9, 3.5998930258409643`*^9}, {
  3.599893247330964*^9, 3.5998932504339647`*^9}, {3.6010962702191677`*^9, 
  3.6010962706434507`*^9}, {3.601096626272691*^9, 3.601096667849411*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "2.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "3.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.`", ",", "2.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.`", ",", "3.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.5`", ",", "2.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.5`", ",", "2.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.5`", ",", "3.`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669075247*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.2027793946151302`", ",", "0.16709042471177077`", ",", 
     "0.15008456543318968`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20426115523299948`", ",", "0.1673051675292797`", ",", 
     "0.15012699164137902`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20518292468904759`", ",", "0.16743494997862027`", ",", 
     "0.150152493541279`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.6010966690772276`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.5337901282404998`", ",", "5.901068021676773`", ",", 
     "14.831495565124317`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.55104259200335`", ",", "5.912267627441228`", ",", 
     "14.839846526880066`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.561514583344216`", ",", "5.919004627414882`", ",", 
     "14.84486050085002`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669078228*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "9.862935057065073`", ",", "24.401774264491443`", ",", 
     "66.59156091219303`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "9.791386902314402`", ",", "24.35480837571138`", ",", 
     "66.55392839603618`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "9.747399804496293`", ",", "24.326496955970175`", ",", 
     "66.5313232770765`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.6010966690822325`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.2027793946151302`", ",", "0.16709042471177077`", ",", 
     "0.15008456543318968`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20426115523299948`", ",", "0.1673051675292797`", ",", 
     "0.15012699164137902`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.20518292468904759`", ",", "0.16743494997862027`", ",", 
     "0.150152493541279`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998841507861614`*^9, 3.599884197502302*^9, {3.5998894088159647`*^9, 
   3.599889423519964*^9}, 3.5998895046509647`*^9, 3.599889550809964*^9, {
   3.5998897002879643`*^9, 3.599889721519964*^9}, 3.599890040328964*^9, 
   3.5998930338659644`*^9, 3.599893252092964*^9, 3.5998942611619644`*^9, 
   3.599898875139964*^9, 3.6010960504968*^9, 3.6010961664460983`*^9, 
   3.601096271509051*^9, 3.601096669083232*^9}]
}, Open  ]],

Cell["\<\
Within row: increase in eta i.e. demand price sensitivity decreases optimal \
price but increases profit (and consumer surplus, which is ok if price \
decreases)
Between rows: increase in gamma i.e. shift of weight in customer valuations \
towards higher valuations increases price and profit (decreases consumer \
surplus)\
\>", "Text",
 CellChangeTimes->{{3.599890391849964*^9, 3.5998904493979645`*^9}, {
  3.5998907144849644`*^9, 3.5998908553879642`*^9}, {3.599890950533964*^9, 
  3.599891000705964*^9}, {3.6010963287461863`*^9, 3.601096557462841*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output for disclosure", "Subsubtitle",
 CellChangeTimes->{{3.5998910549429646`*^9, 3.5998910621309643`*^9}, 
   3.5998990771629643`*^9}],

Cell["\<\
Do it on k and n... (since pretty clear for eta gamma a priori...) => Not \
necessarily loop... check existence of crossing or not for platform profit\
\>", "Text",
 CellChangeTimes->{{3.5998990480609646`*^9, 3.5998990669079647`*^9}, {
  3.6010969490288644`*^9, 3.601096974443806*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{961, 942},
WindowMargins->{{1, Automatic}, {-1, Automatic}},
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 123, 1, 83, "Title"],
Cell[693, 25, 138, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[856, 30, 3140, 86, 132, "Input"],
Cell[3999, 118, 1187, 33, 75, "Output"],
Cell[5189, 153, 1771, 50, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6997, 208, 696, 15, 92, "Input"],
Cell[7696, 225, 421, 6, 30, "Output"],
Cell[8120, 233, 442, 7, 47, "Output"],
Cell[8565, 242, 423, 6, 30, "Output"],
Cell[8991, 250, 440, 6, 30, "Output"]
}, Open  ]],
Cell[9446, 259, 424, 7, 29, "Text"],
Cell[CellGroupData[{
Cell[9895, 270, 2015, 47, 92, "Input"],
Cell[11913, 319, 5626, 111, 348, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17576, 435, 120, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[17721, 440, 1144, 25, 72, "Input"],
Cell[18868, 467, 4116, 100, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23021, 572, 146, 3, 31, "Input"],
Cell[23170, 577, 582, 8, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23801, 591, 170, 2, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[23996, 597, 1927, 49, 92, "Input"],
Cell[25926, 648, 3704, 94, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29667, 747, 502, 11, 92, "Input"],
Cell[30172, 760, 461, 7, 47, "Output"],
Cell[30636, 769, 457, 6, 30, "Output"],
Cell[31096, 777, 457, 6, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31602, 789, 202, 4, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[31829, 797, 539, 11, 31, "Input"],
Cell[32371, 810, 1017, 26, 33, "Output"]
}, Open  ]],
Cell[33403, 839, 259, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[33687, 848, 675, 17, 31, "Input"],
Cell[CellGroupData[{
Cell[34387, 869, 1122, 30, 26, "Print"],
Cell[35512, 901, 1118, 30, 26, "Print"],
Cell[36633, 933, 1122, 30, 26, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37804, 969, 516, 12, 31, "Input"],
Cell[38323, 983, 185, 5, 23, "Print"]
}, Open  ]],
Cell[38523, 991, 379, 6, 29, "Text"],
Cell[CellGroupData[{
Cell[38927, 1001, 672, 17, 31, "Input"],
Cell[CellGroupData[{
Cell[39624, 1022, 1193, 31, 26, "Print"],
Cell[40820, 1055, 1575, 39, 26, "Print"],
Cell[42398, 1096, 1585, 39, 26, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44032, 1141, 567, 13, 31, "Input"],
Cell[44602, 1156, 184, 5, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44835, 1167, 142, 5, 47, "Subsubtitle"],
Cell[CellGroupData[{
Cell[45002, 1176, 1608, 45, 72, "Input"],
Cell[46613, 1223, 3828, 110, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50478, 1338, 1183, 29, 52, "Input"],
Cell[CellGroupData[{
Cell[51686, 1371, 176, 3, 23, "Print"],
Cell[51865, 1376, 176, 3, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52090, 1385, 590, 11, 72, "Input"],
Cell[52683, 1398, 314, 4, 30, "Output"],
Cell[53000, 1404, 296, 4, 30, "Output"],
Cell[53299, 1410, 314, 4, 30, "Output"]
}, Open  ]],
Cell[53628, 1417, 650, 11, 65, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54315, 1433, 160, 5, 47, "Subsubtitle"],
Cell[CellGroupData[{
Cell[54500, 1442, 1177, 27, 52, "Input"],
Cell[55680, 1471, 6509, 180, 108, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62238, 1657, 243, 5, 47, "Subsubtitle"],
Cell[CellGroupData[{
Cell[62506, 1666, 1111, 25, 72, "Input"],
Cell[63620, 1693, 278, 4, 30, "Output"],
Cell[63901, 1699, 314, 5, 30, "Output"],
Cell[64218, 1706, 313, 5, 30, "Output"]
}, Open  ]],
Cell[64546, 1714, 182, 4, 29, "Text"],
Cell[CellGroupData[{
Cell[64753, 1722, 858, 21, 31, "Input"],
Cell[CellGroupData[{
Cell[65636, 1747, 381, 8, 23, "Print"],
Cell[66020, 1757, 378, 8, 23, "Print"],
Cell[66401, 1767, 381, 8, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[66809, 1779, 203, 4, 29, "Text"],
Cell[CellGroupData[{
Cell[67037, 1787, 799, 21, 31, "Input"],
Cell[CellGroupData[{
Cell[67861, 1812, 287, 6, 23, "Print"],
Cell[68151, 1820, 288, 6, 23, "Print"],
Cell[68442, 1828, 287, 6, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68790, 1841, 148, 5, 47, "Subsubtitle"],
Cell[68941, 1848, 4495, 101, 312, "Input"],
Cell[CellGroupData[{
Cell[73461, 1953, 1034, 20, 112, "Input"],
Cell[74498, 1975, 1215, 33, 30, "Output"],
Cell[75716, 2010, 895, 21, 30, "Output"],
Cell[76614, 2033, 881, 21, 30, "Output"],
Cell[77498, 2056, 882, 21, 30, "Output"],
Cell[78383, 2079, 893, 21, 30, "Output"]
}, Open  ]],
Cell[79291, 2103, 565, 10, 47, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79893, 2118, 142, 2, 28, "Subsubtitle"],
Cell[80038, 2122, 295, 5, 29, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
