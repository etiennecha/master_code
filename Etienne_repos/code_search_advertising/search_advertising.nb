(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     25181,        697]
NotebookOptionsPosition[     23644,        643]
NotebookOutlinePosition[     23989,        658]
CellTagsIndexPosition[     23946,        655]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Search Advertising: Numerical analysis", "Title",
 CellChangeTimes->{{3.5989415182915487`*^9, 3.598941530227742*^9}}],

Cell["Model: demand function, consumer type, and profit", "Subsubtitle",
 CellChangeTimes->{{3.598941534916211*^9, 3.598941567204439*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Demand", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", " ", "pbar_", ",", " ", "eta_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"p", " ", ">", " ", "pbar"}]}], "}"}], "}"}], ",", 
    RowBox[{"theta", " ", "+", " ", 
     RowBox[{"p", "^", 
      RowBox[{"(", 
       RowBox[{"-", "eta"}], ")"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InverseDemand", "[", 
   RowBox[{"theta_", ",", " ", "q_", ",", " ", "eta_"}], "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"theta", " ", ">", "q"}]}], "}"}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q", "-", "theta"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "eta"}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CdfTheta", "[", 
   RowBox[{"theta_", ",", " ", "gamma_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"theta", " ", "<", "0"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", 
        RowBox[{"theta", " ", ">", " ", "1"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"theta", "^", "gamma"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PdfTheta", "[", 
    RowBox[{"theta_", ",", " ", "gamma_"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"CdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", "theta"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Profit", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", " ", "pbar_", ",", " ", "eta_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"p", ">", "pbar"}]}], " ", "}"}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "0.1"}], ")"}], "*", 
     RowBox[{"Demand", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivativeProfit", "[", 
   RowBox[{"theta_", ",", " ", "p_", ",", "pbar_", ",", " ", "eta_"}], "]"}], 
  "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Profit", "[", 
     RowBox[{"theta", ",", "p", ",", "pbar", ",", "eta"}], "]"}], ",", "p"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.598937564340193*^9, 3.598937565254284*^9}, {
  3.5989376158323417`*^9, 3.5989376383935976`*^9}, {3.598937716681425*^9, 
  3.5989378639381495`*^9}, {3.598937900915847*^9, 3.5989379040521603`*^9}, {
  3.598937985462301*^9, 3.5989379871104655`*^9}, {3.5989381460443573`*^9, 
  3.598938314211172*^9}, {3.5989384547462244`*^9, 3.598938476491399*^9}, {
  3.5989415781855373`*^9, 3.598941581351854*^9}, {3.5989428182945356`*^9, 
  3.59894287984669*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {"0", 
     RowBox[{"theta", "<", "0"}]},
    {
     RowBox[{"gamma", " ", 
      SuperscriptBox["theta", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "gamma"}]]}], 
     RowBox[{"0", "<", "theta", "<", "1"}]},
    {"0", 
     RowBox[{"theta", ">", "1"}]},
    {"Indeterminate", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.5989428417128773`*^9, 3.5989428812008257`*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {"0", 
     RowBox[{
      RowBox[{"p", "-", "pbar"}], ">", "0"}]},
    {
     RowBox[{
      FractionBox[
       RowBox[{"eta", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.1`"}], "+", "p"}], ")"}], " ", "theta"}], "p"], "-", 
      RowBox[{"eta", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "0.1`"}], "+", "p"}], ")"}], " ", 
       SuperscriptBox["p", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "eta"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[InvisibleSpace]", "+", 
         RowBox[{
          SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["p", 
        RowBox[{"-", "eta"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[InvisibleSpace]", "+", 
         RowBox[{
          SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}]}], 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.5989428417128773`*^9, 3.598942881201826*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Demand", "[", 
  RowBox[{"1", ",", " ", 
   RowBox[{"1", "/", "5"}], ",", " ", "1", ",", " ", "2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"InverseDemand", "[", 
  RowBox[{"1", ",", " ", "26", ",", " ", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Profit", "[", 
  RowBox[{"1", ",", 
   RowBox[{"1", "/", "5"}], ",", "1", ",", "2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CdfTheta", "[", 
  RowBox[{"0.5", ",", "0.5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5989379912248774`*^9, 3.598938018343589*^9}, {
  3.5989381201867723`*^9, 3.5989381320269556`*^9}, {3.598938318577609*^9, 
  3.598938326146366*^9}, {3.5989415867273912`*^9, 3.5989415885345716`*^9}}],

Cell[BoxData["26"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887505937`*^9}}],

Cell[BoxData[
 FractionBox["1", "5"]], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.5989415887515936`*^9}}],

Cell[BoxData["2.6`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.598941588753594*^9}}],

Cell[BoxData["0.7071067811865476`"], "Output",
 CellChangeTimes->{{3.5989380000747623`*^9, 3.598938020044759*^9}, 
   3.5989381325610094`*^9, 3.598938192756028*^9, 3.5989383264403954`*^9, {
   3.598938466014351*^9, 3.5989384810218515`*^9}, {3.5989415867403927`*^9, 
   3.598941588754594*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FirstOrderCondition", "[", 
   RowBox[{"p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_"}], 
   "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeProfit", "[", 
      RowBox[{"theta", ",", " ", "p", ",", " ", "pbar", ",", " ", "eta"}], 
      "]"}], "*", 
     RowBox[{"PdfTheta", "[", 
      RowBox[{"theta", ",", " ", "gamma"}], "]"}]}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"FirstOrderCondition", "[", 
   RowBox[{"p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma"}], "]"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"FirstOrderCondition", "[", 
  RowBox[{"0.202779", ",", " ", "1.0", ",", " ", "2.0", ",", " ", "0.5"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5989392435710993`*^9, 3.598939358184559*^9}, {
   3.598939431356876*^9, 3.5989395598257217`*^9}, 3.5989396221489534`*^9, {
   3.598939661140852*^9, 3.598939665092247*^9}, {3.598940427377468*^9, 
   3.598940462114941*^9}, {3.5989417311658335`*^9, 3.59894178033575*^9}, {
   3.598942878214527*^9, 3.5989429688575907`*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {
     RowBox[{"\[Piecewise]", GridBox[{
        {
         FractionBox[
          RowBox[{"0.1`", " ", 
           SuperscriptBox["p", 
            RowBox[{
             RowBox[{"-", "1.`"}], "-", 
             RowBox[{"1.`", " ", "eta"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{"eta", "+", 
             RowBox[{"eta", " ", "gamma"}], "+", 
             RowBox[{"10.`", " ", "p"}], "-", 
             RowBox[{"10.`", " ", "eta", " ", "p"}], "+", 
             RowBox[{"10.`", " ", "gamma", " ", "p"}], "-", 
             RowBox[{"10.`", " ", "eta", " ", "gamma", " ", "p"}], "+", 
             RowBox[{"10.`", " ", "gamma", " ", 
              SuperscriptBox["p", 
               RowBox[{"1.`", "\[InvisibleSpace]", "+", "eta"}]]}]}], ")"}]}], 
          RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma"}]], 
         RowBox[{
          RowBox[{"Re", "[", "gamma", "]"}], ">", "0.`"}]},
        {
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"0.1`", " ", "gamma", " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1.`"}], "-", 
              RowBox[{"1.`", " ", "eta"}]}]], " ", 
            SuperscriptBox["theta", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "gamma"}]], " ", 
            RowBox[{"(", 
             RowBox[{"eta", "+", 
              RowBox[{"10.`", " ", "p"}], "-", 
              RowBox[{"10.`", " ", "eta", " ", "p"}], "+", 
              RowBox[{"10.`", " ", 
               SuperscriptBox["p", 
                RowBox[{"1.`", "\[InvisibleSpace]", "+", "eta"}]], " ", 
               "theta"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"theta", ",", "0.`", ",", "1.`"}], "}"}], ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "-", 
               RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}], "&&", 
             RowBox[{
              RowBox[{"Re", "[", "gamma", "]"}], "\[LessEqual]", 
              "0.`"}]}]}]}], "]"}], 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->False,
          DeletionWarning->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}], 
     RowBox[{
      RowBox[{"p", "-", 
       RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}]},
    {"0.`", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.598939481074847*^9, 3.598939486616401*^9}, {
   3.598939518746614*^9, 3.5989395613598747`*^9}, 3.598939625590297*^9, 
   3.5989396669874363`*^9, {3.598940430139744*^9, 3.5989404425229826`*^9}, 
   3.598940763352062*^9, 3.598941605405259*^9, {3.598941737456463*^9, 
   3.59894178123884*^9}, {3.598942935833288*^9, 3.5989429710398088`*^9}}],

Cell[BoxData["0.00004538050585388973`"], "Output",
 CellChangeTimes->{{3.598939481074847*^9, 3.598939486616401*^9}, {
   3.598939518746614*^9, 3.5989395613598747`*^9}, 3.598939625590297*^9, 
   3.5989396669874363`*^9, {3.598940430139744*^9, 3.5989404425229826`*^9}, 
   3.598940763352062*^9, 3.598941605405259*^9, {3.598941737456463*^9, 
   3.59894178123884*^9}, {3.598942935833288*^9, 3.598942971088814*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results: Profit, CS, Welfare", "Subsubtitle",
 CellChangeTimes->{{3.598941419983719*^9, 3.5989414228960094`*^9}, {
  3.598941474082128*^9, 3.5989414854902687`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpectedTheta", "[", "gamma_", "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"theta", "*", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"CdfTheta", "[", 
        RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", " ", "theta"}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"theta", ",", "0", ",", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedProfit", "[", 
   RowBox[{"p_", ",", " ", "pbar_", ",", " ", "eta_", ",", " ", "gamma_"}], 
   "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Profit", "[", 
      RowBox[{"theta", ",", "p", ",", "pbar", ",", "eta"}], "]"}], "*", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"CdfTheta", "[", 
        RowBox[{"theta", ",", " ", "gamma"}], "]"}], ",", " ", "theta"}], 
      "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"theta", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedConsumerSurplus", "[", 
   RowBox[{"theta_", ",", " ", "qstar_", ",", " ", "eta_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"InverseDemand", "[", 
     RowBox[{"theta", ",", " ", "q", ",", " ", "eta"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"q", ",", " ", "0", ",", " ", "qstar"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"ExpectedProfit", "[", 
   RowBox[{"p", ",", " ", "pbar", ",", " ", "eta", ",", " ", "gamma"}], "]"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExpectedTheta", "[", "0.5", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExpectedProfit", "[", 
  RowBox[{"0.2", ",", " ", "1.0", ",", " ", "2.0", ",", " ", "0.5"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExpectedConsumerSurplus", "[", 
  RowBox[{
   RowBox[{"ExpectedTheta", "[", "0.5", "]"}], ",", "26", ",", " ", "2.0"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5989405052002497`*^9, 3.598940701976925*^9}, {
  3.59894079833356*^9, 3.5989409393626614`*^9}, {3.598941023830107*^9, 
  3.59894102426315*^9}, {3.5989410862973533`*^9, 3.598941087288452*^9}, {
  3.5989418268023963`*^9, 3.598941846354351*^9}}],

Cell[BoxData[
 RowBox[{"\[Piecewise]", GridBox[{
    {
     RowBox[{"\[Piecewise]", GridBox[{
        {
         FractionBox[
          RowBox[{"0.1`", " ", 
           SuperscriptBox["p", 
            RowBox[{
             RowBox[{"-", "1.`"}], " ", "eta"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1.`"}], "+", 
             RowBox[{"10.`", " ", "p"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma", "+", 
             RowBox[{"gamma", " ", 
              SuperscriptBox["p", "eta"]}]}], ")"}]}], 
          RowBox[{"1.`", "\[InvisibleSpace]", "+", "gamma"}]], 
         RowBox[{
          RowBox[{"Re", "[", "gamma", "]"}], ">", "0.`"}]},
        {
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"0.1`", " ", "gamma", " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1.`"}], " ", "eta"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", 
              RowBox[{"10.`", " ", "p"}]}], ")"}], " ", 
            SuperscriptBox["theta", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "gamma"}]], " ", 
            RowBox[{"(", 
             RowBox[{"1.`", "\[InvisibleSpace]", "+", 
              RowBox[{
               SuperscriptBox["p", "eta"], " ", "theta"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"theta", ",", "0.`", ",", "1.`"}], "}"}], ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "-", 
               RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}], "&&", 
             RowBox[{
              RowBox[{"Re", "[", "gamma", "]"}], "\[LessEqual]", 
              "0.`"}]}]}]}], "]"}], 
         TagBox["True",
          "PiecewiseDefault",
          AutoDelete->False,
          DeletionWarning->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}], 
     RowBox[{
      RowBox[{"p", "-", 
       RowBox[{"1.`", " ", "pbar"}]}], "\[LessEqual]", "0.`"}]},
    {"0.`", 
     TagBox["True",
      "PiecewiseDefault",
      AutoDelete->False,
      DeletionWarning->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.84]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}]}]], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519589005`*^9}],

Cell[BoxData[
 FractionBox["1", "3"]], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.5989429519799027`*^9}],

Cell[BoxData["2.5333333333333328`"], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.598942952029908*^9}],

Cell[BoxData["10.132456102380443`"], "Output",
 CellChangeTimes->{{3.598940869929719*^9, 3.59894094064979*^9}, {
   3.598941016672392*^9, 3.5989410257532997`*^9}, 3.5989410887676*^9, 
   3.5989416111208305`*^9, {3.5989418388225985`*^9, 3.598941848103526*^9}, 
   3.598942952081913*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation of equilibria", "Subsubtitle",
 CellChangeTimes->{{3.598942016165331*^9, 3.5989420462623405`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FirstOrderCondition", "[", 
     RowBox[{"p", ",", " ", "1.0", ",", " ", "2.0", ",", " ", "0.5"}], "]"}], 
    " ", "\[Equal]", " ", "0"}], ",", " ", "p"}], "]"}]], "Input",
 CellChangeTimes->{{3.5989418839861145`*^9, 3.5989419391716323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseFunction", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used. Values may be lost for multivalued inverses.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/InverseFunction\\\", ButtonNote -> \
\\\"InverseFunction::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.598941922767992*^9, 3.598941941040819*^9}, 
   3.59894298345605*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseFunction", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used. Values may be lost for multivalued inverses.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/InverseFunction\\\", ButtonNote -> \
\\\"InverseFunction::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.598941922767992*^9, 3.598941941040819*^9}, 
   3.5989429834580507`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"1.`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.`", " ", 
       RowBox[{
        TagBox[
         SuperscriptBox["UnitStep", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]],
         {InverseFunction, 1, 1},
         Editable->False], "[", "0.`", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"-", "1.8245148778558737`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0.20277939461513023`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "1.6217354832407433`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5989419228880043`*^9, 3.5989419410468197`*^9}, 
   3.59894298345905*^9}]
}, Open  ]],

Cell["\<\
Text: to do: loop on solutions to check max profit (here clearly on the third \
is a max... could be two non negative profit?)\
\>", "Text",
 CellChangeTimes->{{3.5989423035040617`*^9, 3.5989423299847097`*^9}}]
}, Open  ]],

Cell["Order statistics", "Subsubtitle",
 CellChangeTimes->{{3.598943000248729*^9, 3.598943003640068*^9}}]
}, Open  ]]
},
WindowSize->{1433, 967},
WindowMargins->{{Automatic, 19}, {Automatic, 9}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 123, 1, 83, "Title"],
Cell[693, 25, 138, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[856, 30, 3039, 85, 132, "Input"],
Cell[3898, 117, 1039, 31, 75, "Output"],
Cell[4940, 150, 1621, 48, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6598, 203, 696, 15, 92, "Input"],
Cell[7297, 220, 277, 4, 30, "Output"],
Cell[7577, 226, 296, 5, 47, "Output"],
Cell[7876, 233, 277, 4, 30, "Output"],
Cell[8156, 239, 292, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8485, 248, 1241, 27, 92, "Input"],
Cell[9729, 277, 3914, 97, 83, "Output"],
Cell[13646, 376, 409, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14092, 386, 170, 2, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[14287, 392, 2200, 56, 152, "Input"],
Cell[16490, 450, 3508, 92, 83, "Output"],
Cell[20001, 544, 289, 5, 47, "Output"],
Cell[20293, 551, 285, 4, 30, "Output"],
Cell[20581, 557, 285, 4, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20915, 567, 116, 1, 28, "Subsubtitle"],
Cell[CellGroupData[{
Cell[21056, 572, 317, 7, 31, "Input"],
Cell[21376, 581, 559, 11, 21, "Message"],
Cell[21938, 594, 562, 11, 21, "Message"],
Cell[22503, 607, 770, 22, 33, "Output"]
}, Open  ]],
Cell[23288, 632, 220, 4, 29, "Text"]
}, Open  ]],
Cell[23523, 639, 105, 1, 28, "Subsubtitle"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
